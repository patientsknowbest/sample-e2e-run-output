<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>QuestionnaireServiceClientImpl.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">E2E Tests Coverage Report</a> &gt; <a href="index.source.html" class="el_package">com.pkb.questionnaireservice.client</a> &gt; <span class="el_source">QuestionnaireServiceClientImpl.kt</span></div><h1>QuestionnaireServiceClientImpl.kt</h1><pre class="source lang-java linenums">package com.pkb.questionnaireservice.client

import com.pkb.questionnaireservice.OrgPublicId
import com.pkb.questionnaireservice.PersonPublicId
import com.pkb.questionnaireservice.QuestionnaireId
import com.pkb.questionnaireservice.QuestionnaireRequestId
import com.pkb.questionnaireservice.TeamPublicId
import com.pkb.questionnaireservice.messages.LowerBound
import com.pkb.questionnaireservice.messages.UpperBound
import com.pkb.questionnaireservice.modelv2.Questionnaire
import com.pkb.questionnaireservice.modelv2.QuestionnaireRequest
import com.pkb.questionnaireservice.modelv2.QuestionnaireResponse
import com.pkb.questionnaireservice.modelv2.QuestionnaireResponseCount
import com.pkb.questionnaireservice.modelv2.QuestionnaireServiceError
import com.pkb.questionnaireservice.modelv2.QuestionnaireTeam
import com.pkb.questionnaireservice.modelv2.SearchResults
import io.vavr.control.Either
import okhttp3.OkHttpClient
import java.time.Instant
import java.util.Collections.emptyList
import java.util.UUID

<span class="pc" id="L23">class QuestionnaireServiceClientImpl(baseUrl: String = &quot;http://localhost:8080&quot;, client: OkHttpClient = OkHttpClient(), ) : QuestionnaireServiceClient {</span>

<span class="fc" id="L25">    private val retrofit: QuestionnaireServiceRetrofit = QuestionnaireServiceRetrofit.questionnaireServiceRetrofit(baseUrl, client)</span>

    override fun postQuestionnaire(requestID: UUID?, q: Questionnaire): Either&lt;QuestionnaireServiceError, Questionnaire&gt; =
<span class="nc" id="L28">            retrofit.postQuestionnaire(requestID, q)</span>

    override fun postQuestionnaireAndLinkToTeam(requestID: UUID?, questionnaireTeamLink: QuestionnaireTeam): Either&lt;QuestionnaireServiceError, QuestionnaireTeam&gt; =
<span class="fc" id="L31">            retrofit.postQuestionnaireAndLinkToTeam(requestID, questionnaireTeamLink)</span>

    override fun getQuestionnaireTeamByQuestionnaireIdAndTeamId(requestID: UUID?, questionnaireId: QuestionnaireId, teamIds: List&lt;TeamPublicId&gt;): Either&lt;QuestionnaireServiceError, List&lt;QuestionnaireTeam&gt;&gt; {
<span class="pc bpc" id="L34" title="1 of 2 branches missed.">        return if (teamIds.isEmpty()) Either.right(emptyList()) else retrofit.getQuestionnaireTeamByQuestionnaireIdAndTeamId(requestID, questionnaireId, teamIds)</span>
    }

    override fun getQuestionnaireTeamByQuestionnaireRequestId(requestID: UUID?, questionnaireId: QuestionnaireRequestId): Either&lt;QuestionnaireServiceError, QuestionnaireTeam&gt; =
<span class="fc" id="L38">            retrofit.getQuestionnaireTeamByQuestionnaireRequestId(requestID, questionnaireId)</span>

    override fun getQuestionnaireTeamsInTeam(requestID: UUID?, id: TeamPublicId, includeHidden: Boolean): Either&lt;QuestionnaireServiceError, List&lt;QuestionnaireTeam&gt;&gt; =
<span class="fc" id="L41">            retrofit.getQuestionnaireTeamsInTeam(requestID, id, includeHidden)</span>

    override fun getQuestionnaireTeamsInTeams(requestID: UUID?, ids: List&lt;TeamPublicId&gt;, includeHidden: Boolean): Either&lt;QuestionnaireServiceError, List&lt;QuestionnaireTeam&gt;&gt; {
<span class="pc bpc" id="L44" title="1 of 2 branches missed.">        return if (ids.isEmpty()) Either.right(emptyList()) else retrofit.getQuestionnaireTeamsInTeams(requestID, ids, includeHidden)</span>
    }

    override fun updateTeamLink(requestID: UUID?, questionnaireTeamLink: QuestionnaireTeam): Either&lt;QuestionnaireServiceError, QuestionnaireTeam&gt; =
<span class="fc" id="L48">            retrofit.updateTeamLink(requestID, questionnaireTeamLink)</span>

    override fun getQuestionnaireById(requestID: UUID?, id: QuestionnaireId): Either&lt;QuestionnaireServiceError, Questionnaire&gt; =
<span class="fc" id="L51">            retrofit.getQuestionnaireById(requestID, id)</span>

    override fun getQuestionnairesInTeams(requestID: UUID?, ids: List&lt;TeamPublicId&gt;, includeHidden: Boolean, limit: Int): Either&lt;QuestionnaireServiceError, SearchResults&lt;Questionnaire&gt;&gt; {
<span class="pc bpc" id="L54" title="1 of 2 branches missed.">        return if (ids.isEmpty()) Either.right(SearchResults(emptyList(), 0)) else retrofit.getQuestionnairesInTeams(requestID, ids, includeHidden, limit)</span>
    }

    override fun getQuestionnairesInTeams(requestID: UUID?, ids: List&lt;TeamPublicId&gt;, includeHidden: Boolean): Either&lt;QuestionnaireServiceError, SearchResults&lt;Questionnaire&gt;&gt; {
<span class="fc bfc" id="L58" title="All 2 branches covered.">        return if (ids.isEmpty()) Either.right(SearchResults(emptyList(), 0)) else retrofit.getQuestionnairesInTeams(requestID, ids, includeHidden)</span>
    }

    override fun getQuestionnairesInTeam(requestID: UUID?, id: TeamPublicId, includeHidden: Boolean, limit: Int): Either&lt;QuestionnaireServiceError, SearchResults&lt;Questionnaire&gt;&gt; =
<span class="nc" id="L62">            retrofit.getQuestionnairesInTeam(requestID, id, includeHidden, limit)</span>

    override fun getQuestionnairesInTeam(requestID: UUID?, id: TeamPublicId, includeHidden: Boolean): Either&lt;QuestionnaireServiceError, SearchResults&lt;Questionnaire&gt;&gt; =
<span class="fc" id="L65">            retrofit.getQuestionnairesInTeam(requestID, id, includeHidden)</span>

    override fun postQuestionnaireRequest(requestID: UUID?, q: QuestionnaireRequest): Either&lt;QuestionnaireServiceError,QuestionnaireRequest&gt; =
<span class="fc" id="L68">            retrofit.postQuestionnaireRequest(requestID, q)</span>

    override fun postQuestionnaireRequestsBatch(requestID: UUID, requests: List&lt;QuestionnaireRequest&gt;): Either&lt;QuestionnaireServiceError,List&lt;QuestionnaireRequest&gt;&gt; =
<span class="fc" id="L71">            retrofit.postQuestionnaireRequestsBatch(requestID, requests)</span>

    override fun getQuestionnaireRequest(requestID: UUID?, id: QuestionnaireRequestId): Either&lt;QuestionnaireServiceError, QuestionnaireRequest&gt; =
<span class="fc" id="L74">            retrofit.getQuestionnaireRequest(requestID, id)</span>

    override fun getQuestionnaireRequestsForQuestionnaires(requestID: UUID?, questionnaireIds: List&lt;QuestionnaireId&gt;, limit: Int): Either&lt;QuestionnaireServiceError, SearchResults&lt;QuestionnaireRequest&gt;&gt; {
<span class="nc bnc" id="L77" title="All 2 branches missed.">        return if (questionnaireIds.isEmpty()) Either.right(SearchResults(emptyList(), 0)) else retrofit.getQuestionnaireRequestsForQuestionnaires(requestID, questionnaireIds, limit)</span>
    }

    override fun getQuestionnaireRequestsForQuestionnaires(requestID: UUID?, questionnaireIds: List&lt;QuestionnaireId&gt;): Either&lt;QuestionnaireServiceError, SearchResults&lt;QuestionnaireRequest&gt;&gt; {
<span class="nc bnc" id="L81" title="All 2 branches missed.">        return if (questionnaireIds.isEmpty()) Either.right(SearchResults(emptyList(), 0)) else retrofit.getQuestionnaireRequestsForQuestionnaires(requestID, questionnaireIds)</span>
    }

    override fun postQuestionnaireResponse(requestID: UUID?, q: QuestionnaireResponse): Either&lt;QuestionnaireServiceError, QuestionnaireResponse&gt; =
<span class="fc" id="L85">            retrofit.postQuestionnaireResponse(requestID, q)</span>

    override fun getQuestionnaireResponses(requestID: UUID?, id: QuestionnaireId, loggedInUserId: PersonPublicId, limit: Int): Either&lt;QuestionnaireServiceError, SearchResults&lt;QuestionnaireResponse&gt;&gt; =
<span class="nc" id="L88">            retrofit.getQuestionnaireResponses(requestID, id, loggedInUserId, limit)</span>

    override fun getQuestionnaireResponses(requestID: UUID?, id: QuestionnaireId, loggedInUserId: PersonPublicId): Either&lt;QuestionnaireServiceError, SearchResults&lt;QuestionnaireResponse&gt;&gt; =
<span class="nc" id="L91">            retrofit.getQuestionnaireResponses(requestID, id, loggedInUserId)</span>

    override fun getQuestionnaireResponseCountsByTeamId(requestID: UUID?, teamId: TeamPublicId): Either&lt;QuestionnaireServiceError, List&lt;QuestionnaireResponseCount&gt;&gt; =
<span class="fc" id="L94">            retrofit.getQuestionnaireResponseCountsByTeamId(requestID, teamId)</span>

    override fun getQuestionnaireResponsesWithinOrg(requestID: UUID?,
                                           orgId: OrgPublicId,
                                           teamIds: List&lt;TeamPublicId&gt;,
                                           patientIds: List&lt;PersonPublicId&gt;?,
                                           questionnaireId: QuestionnaireId?,
                                           startDate: LowerBound?,
                                           endDate: UpperBound?,
                                           limit: Int?) : Either&lt;QuestionnaireServiceError, SearchResults&lt;QuestionnaireResponse&gt;&gt; {
<span class="nc" id="L104">        val (gt, ge) = when (startDate) {</span>
<span class="nc bnc" id="L105" title="All 2 branches missed.">            is LowerBound.GreaterThan -&gt; Pair(startDate.date, null)</span>
<span class="nc bnc" id="L106" title="All 2 branches missed.">            is LowerBound.GreaterOrEqualTo -&gt; Pair(null, startDate.date)</span>
<span class="nc bnc" id="L107" title="All 2 branches missed.">            null -&gt; Pair(null, null)</span>
        }
<span class="nc" id="L109">        val (lt, le) = when (endDate) {</span>
<span class="nc bnc" id="L110" title="All 2 branches missed.">            is UpperBound.LowerThan -&gt; Pair(endDate.date, null)</span>
<span class="nc bnc" id="L111" title="All 2 branches missed.">            is UpperBound.LowerOrEqualTo -&gt; Pair(null, endDate.date)</span>
<span class="nc bnc" id="L112" title="All 2 branches missed.">            null -&gt; Pair(null, null)</span>
        }
<span class="nc" id="L114">        return retrofit.getQuestionnaireResponsesWithinOrg(requestID, orgId, teamIds, patientIds, questionnaireId,</span>
<span class="nc" id="L115">                lt, le, gt, ge, limit)</span>
    }

    override fun getQuestionnaireResponsesWithinOrg(requestID: UUID?,
                                                    orgId: OrgPublicId,
                                                    teamIds: List&lt;TeamPublicId&gt;,
                                                    patientIds: List&lt;PersonPublicId&gt;?,
                                                    questionnaireId: QuestionnaireId?,
                                                    ltDate: Instant?,
                                                    leDate: Instant?,
                                                    gtDate: Instant?,
                                                    geDate: Instant?,
                                                    limit: Int?): Either&lt;QuestionnaireServiceError, SearchResults&lt;QuestionnaireResponse&gt;&gt; =
<span class="fc" id="L128">            retrofit.getQuestionnaireResponsesWithinOrg(requestID, orgId, teamIds, patientIds, questionnaireId, ltDate, leDate, gtDate, geDate, limit)</span>

<span class="nc" id="L130">}</span>
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>