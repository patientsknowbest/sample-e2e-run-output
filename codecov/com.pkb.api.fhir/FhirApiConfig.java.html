<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>FhirApiConfig.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">E2E Tests Coverage Report</a> &gt; <a href="index.source.html" class="el_package">com.pkb.api.fhir</a> &gt; <span class="el_source">FhirApiConfig.java</span></div><h1>FhirApiConfig.java</h1><pre class="source lang-java linenums">package com.pkb.api.fhir;

import ca.uhn.fhir.context.FhirContext;
import ca.uhn.fhir.rest.server.HardcodedServerAddressStrategy;
import ca.uhn.fhir.rest.server.IResourceProvider;
import ca.uhn.fhir.rest.server.IServerAddressStrategy;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.datatype.guava.GuavaModule;
import com.pkb.api.fhir.address.AddressMapper;
import com.pkb.api.fhir.appointment.AppointmentMapper;
import com.pkb.api.fhir.appointment.AppointmentResourceService;
import com.pkb.api.fhir.communication.CommunicationMapper;
import com.pkb.api.fhir.communication.CommunicationResourceService;
import com.pkb.api.fhir.config.FhirApiProperties;
import com.pkb.api.fhir.config.HybridMailProperties;
import com.pkb.api.fhir.config.OAuth2Properties;
import com.pkb.api.fhir.consent.ConsentMapper;
import com.pkb.api.fhir.consent.ConsentResourceService;
import com.pkb.api.fhir.contact.ContactPointMapper;
import com.pkb.api.fhir.converter.DateParamToDateRestrictionConverter;
import com.pkb.api.fhir.converter.DateRangeParamToDateRangeRestrictionConverter;
import com.pkb.api.fhir.converter.IdentifierConverter;
import com.pkb.api.fhir.converter.IncludeConverter;
import com.pkb.api.fhir.converter.ReferenceParamToUUIDConverter;
import com.pkb.api.fhir.converter.ReferenceToTypeAndUUIDConverter;
import com.pkb.api.fhir.converter.ReverseIncludeConverter;
import com.pkb.api.fhir.converter.TokenParamToDiagnosticReportCategoryConverter;
import com.pkb.api.fhir.converter.TokenParamToDocumentStatusConverter;
import com.pkb.api.fhir.converter.TokenParamToObservationCategoryConverter;
import com.pkb.api.fhir.converter.UUIDConverter;
import com.pkb.api.fhir.converter.UrnUUIDConverter;
import com.pkb.api.fhir.diagnosticreport.DiagnosticReportMapper;
import com.pkb.api.fhir.diagnosticreport.DiagnosticReportResourceService;
import com.pkb.api.fhir.document.DocumentReferenceMapper;
import com.pkb.api.fhir.documentreference.DocumentReferenceResourceService;
import com.pkb.api.fhir.encounter.EncounterMapper;
import com.pkb.api.fhir.encounter.EncounterResourceService;
import com.pkb.api.fhir.exception.ServerResponseExceptionMapper;
import com.pkb.api.fhir.foundation.ReferenceMapper;
import com.pkb.api.fhir.interceptors.AuthenticationExceptionHandlingInterceptor;
import com.pkb.api.fhir.interceptors.AuthenticationExtractingInterceptor;
import com.pkb.api.fhir.interceptors.ContentTypeInterceptor;
import com.pkb.api.fhir.interceptors.ExceptionLoggingInterceptor;
import com.pkb.api.fhir.interceptors.MetricsInterceptor;
import com.pkb.api.fhir.interceptors.RequestIdInterceptor;
import com.pkb.api.fhir.namingsystem.OrgLevelIdTypeMapper;
import com.pkb.api.fhir.namingsystem.TeamLevelIdTypeMapper;
import com.pkb.api.fhir.observation.ObservationMapper;
import com.pkb.api.fhir.observation.ObservationResourceService;
import com.pkb.api.fhir.org.LetterInvitationResourceService;
import com.pkb.api.fhir.org.NamingSystemResourceService;
import com.pkb.api.fhir.org.OrganizationResourceService;
import com.pkb.api.fhir.organization.OrganizationMapper;
import com.pkb.api.fhir.parameters.ParametersToPatientIdentifiersDTOMapper;
import com.pkb.api.fhir.patient.PatientResourceService;
import com.pkb.api.fhir.person.HumanNameMapper;
import com.pkb.api.fhir.person.PatientMapper;
import com.pkb.api.fhir.person.PersonMapper;
import com.pkb.api.fhir.person.PersonResourceService;
import com.pkb.api.fhir.person.PractitionerMapper;
import com.pkb.api.fhir.person.RelatedPersonMapper;
import com.pkb.api.fhir.practitioner.PractitionerResourceService;
import com.pkb.api.fhir.provenance.ProvenanceMapper;
import com.pkb.api.fhir.questionnaire.ProcedureRequestResourceService;
import com.pkb.api.fhir.questionnaire.QuestionnaireMapper;
import com.pkb.api.fhir.questionnaire.QuestionnaireRequestMapper;
import com.pkb.api.fhir.questionnaire.QuestionnaireResourceService;
import com.pkb.api.fhir.questionnaire.QuestionnaireResponseMapper;
import com.pkb.api.fhir.questionnaire.QuestionnaireResponseResourceService;
import com.pkb.api.fhir.resourceprovider.AppointmentResourceProvider;
import com.pkb.api.fhir.resourceprovider.CommunicationResourceProvider;
import com.pkb.api.fhir.resourceprovider.ConsentResourceProvider;
import com.pkb.api.fhir.resourceprovider.DiagnosticReportResourceProvider;
import com.pkb.api.fhir.resourceprovider.DocumentReferenceResourceProvider;
import com.pkb.api.fhir.resourceprovider.EncounterResourceProvider;
import com.pkb.api.fhir.resourceprovider.NamingSystemResourceProvider;
import com.pkb.api.fhir.resourceprovider.ObservationResourceProvider;
import com.pkb.api.fhir.resourceprovider.OrganizationResourceProvider;
import com.pkb.api.fhir.resourceprovider.PatientResourceProvider;
import com.pkb.api.fhir.resourceprovider.PersonDeleteResourceProvider;
import com.pkb.api.fhir.resourceprovider.PersonResourceProvider;
import com.pkb.api.fhir.resourceprovider.PractitionerResourceProvider;
import com.pkb.api.fhir.resourceprovider.ProcedureRequestResourceProvider;
import com.pkb.api.fhir.resourceprovider.QuestionnaireResourceProvider;
import com.pkb.api.fhir.resourceprovider.QuestionnaireResponseResourceProvider;
import com.pkb.api.fhir.service.AuthenticationService;
import com.pkb.api.fhir.util.NamedParameterFactory;
import com.pkb.authentication.AccessTokenMapper;
import com.pkb.authentication.AuthenticatedIdentityService;
import com.pkb.authentication.DbBackedAccessTokenBasedLoginService;
import com.pkb.authentication.Oauth2ServiceBackedJwtBasedLoginService;
import com.pkb.authentication.repository.AuthnDataRepository;
import com.pkb.authz.AuthorizationDataService;
import com.pkb.authz.AuthorizationService;
import com.pkb.authz.PolicyBasedAuthorizationService;
import com.pkb.authz.RepositoryBackedAuthorizationDataService;
import com.pkb.authz.policy.definitions.AppointmentPolicyProvider;
import com.pkb.authz.policy.definitions.CommunicationPolicyProvider;
import com.pkb.authz.policy.definitions.ConsentPolicyProvider;
import com.pkb.authz.policy.definitions.DocumentMessagePolicyProvider;
import com.pkb.authz.policy.definitions.EncounterPolicyProvider;
import com.pkb.authz.policy.definitions.InvitationTokenPolicyProvider;
import com.pkb.authz.policy.definitions.LabResultPolicyProvider;
import com.pkb.authz.policy.definitions.LocalIdTypePolicyProvider;
import com.pkb.authz.policy.definitions.OrganizationPolicyProvider;
import com.pkb.authz.policy.definitions.PatientDateOfLastDataPointPolicyProvider;
import com.pkb.authz.policy.definitions.PatientPolicyProvider;
import com.pkb.authz.policy.definitions.PatientStatusPolicyProvider;
import com.pkb.authz.policy.definitions.PersonPolicyProvider;
import com.pkb.authz.policy.definitions.PolicyProvider;
import com.pkb.authz.policy.definitions.PractitionerPolicyProvider;
import com.pkb.authz.policy.definitions.PurviewPolicyProvider;
import com.pkb.authz.policy.definitions.QuestionnairePolicyProvider;
import com.pkb.authz.policy.definitions.QuestionnaireRequestPolicyProvider;
import com.pkb.authz.policy.definitions.QuestionnaireResponsePolicyProvider;
import com.pkb.authz.policy.definitions.RadiologyImagePolicyProvider;
import com.pkb.authz.policy.definitions.ReadReceiptPolicyProvider;
import com.pkb.client.email.ReactorEmailGrpc;
import com.pkb.client.message.ReactorMessageGrpc;
import com.pkb.common.ClearableInternalState;
import com.pkb.common.config.BaseConfig;
import com.pkb.common.config.ConfigStorage;
import com.pkb.common.config.ConfigurationPropertiesScopingPostProcessor;
import com.pkb.common.config.SpringBootConfigStorage;
import com.pkb.common.datetime.DateTimeService;
import com.pkb.common.datetime.DefaultDateTimeService;
import com.pkb.common.datetime.FakeDateTimeService;
import com.pkb.common.testcontrol.config.ITestControlServiceConfig;
import com.pkb.common.testcontrol.config.TestControlServiceConfig;
import com.pkb.common.testcontrol.services.DefaultPubSubNamespaceService;
import com.pkb.common.testcontrol.services.PubSubNamespaceService;
import com.pkb.common.testlogging.DefaultDetailLoggingProvider;
import com.pkb.common.testlogging.DetailLoggingProvider;
import com.pkb.datamodel.DatamodelEntityMappersConfig;
import com.pkb.datamodel.crypto.CryptoService;
import com.pkb.datamodel.entity.mapper.AccountKeysMapper;
import com.pkb.datamodel.entity.mapper.AccountMapper;
import com.pkb.datamodel.entity.mapper.AppointmentParticipantMapper;
import com.pkb.datamodel.entity.mapper.DateOfLastDataPointMapper;
import com.pkb.datamodel.entity.mapper.DocumentMessageMapper;
import com.pkb.datamodel.entity.mapper.LabResultMapper;
import com.pkb.datamodel.entity.mapper.LetterInvitationMapper;
import com.pkb.datamodel.entity.mapper.PatientConsentMapper;
import com.pkb.datamodel.entity.mapper.PersonDemographicsMapper;
import com.pkb.datamodel.entity.mapper.RadiologyMapper;
import com.pkb.datamodel.entity.mapper.TeamMapper;
import com.pkb.datamodel.entity.mapper.TeamWithOrgMapper;
import com.pkb.domain.ConsentService;
import com.pkb.domain.OrgLevelIdTypeService;
import com.pkb.domain.PatientDemographicsService;
import com.pkb.domain.PatientService;
import com.pkb.domain.PractitionerDemographicsService;
import com.pkb.domain.SynchUploadedDataService;
import com.pkb.domain.TeamLevelIdTypeService;
import com.pkb.domain.TeamService;
import com.pkb.domain.appointment.AppointmentService;
import com.pkb.domain.communication.CommunicationService;
import com.pkb.domain.config.DeletionServiceConfiguration;
import com.pkb.domain.config.DomainServiceProperties;
import com.pkb.domain.config.FhirPkbDomainRepositoryProperties;
import com.pkb.domain.config.LetterInvitationProperties;
import com.pkb.domain.document.DocumentService;
import com.pkb.domain.encounter.EncounterService;
import com.pkb.domain.internal.repository.AccountSymmetricKeyRepository;
import com.pkb.domain.internal.repository.AccountUserRepository;
import com.pkb.domain.internal.repository.AppMenuDataRepository;
import com.pkb.domain.internal.repository.InstituteUserRepository;
import com.pkb.domain.internal.repository.JooqSupportRepository;
import com.pkb.domain.internal.repository.ReferenceDatumRepository;
import com.pkb.domain.internal.repository.UserAccountKeyLinkRepository;
import com.pkb.domain.labresult.LabResultService;
import com.pkb.domain.letterinvitation.LetterInvitationService;
import com.pkb.domain.letterinvitation.LetterInvitationTokenService;
import com.pkb.domain.letterinvitation.LetterInvitationValidatorService;
import com.pkb.domain.person.PersonService;
import com.pkb.domain.questionnaire.QuestionnaireResponseService;
import com.pkb.domain.questionnaire.QuestionnaireService;
import com.pkb.domain.radiology.RadiologyService;
import com.pkb.domain.repository.AccountRepository;
import com.pkb.domain.repository.ApiAuthSessionRepository;
import com.pkb.domain.repository.AppointmentParticipantRepository;
import com.pkb.domain.repository.AppointmentRepository;
import com.pkb.domain.repository.AuthorizationDataRepository;
import com.pkb.domain.repository.CommunicationRepository;
import com.pkb.domain.repository.DeleteRequestRepository;
import com.pkb.domain.repository.DocumentMessageRepository;
import com.pkb.domain.repository.EncounterRepository;
import com.pkb.domain.repository.LabResultRepository;
import com.pkb.domain.repository.LetterInvitationRepository;
import com.pkb.domain.repository.MenuDataPointRepository;
import com.pkb.domain.repository.MenuDataTargetOwnerFinder;
import com.pkb.domain.repository.NationalIdRepository;
import com.pkb.domain.repository.OrgLevelIdRepository;
import com.pkb.domain.repository.OrgLevelIdTypeRepository;
import com.pkb.domain.repository.OrgRepository;
import com.pkb.domain.repository.PatientConsentRepository;
import com.pkb.domain.repository.PersonDemographicsRepository;
import com.pkb.domain.repository.PersonRepository;
import com.pkb.domain.repository.RadiologyRepository;
import com.pkb.domain.repository.ReadReceiptRepository;
import com.pkb.domain.repository.TeamLevelIdRepository;
import com.pkb.domain.repository.TeamLevelIdTypeRepository;
import com.pkb.domain.repository.TeamRepository;
import com.pkb.domain.repository.UnreadableDocumentRepository;
import com.pkb.domain.repository.mapper.AccessFilterMapper;
import com.pkb.domain.repository.mapper.SearchSpecMapper;
import com.pkb.domain.repository.mapper.TargetOwnerDataMapper;
import com.pkb.domain.repository.util.AccessFilters;
import com.pkb.fhir.config.OrchestrationProperties;
import com.pkb.fhir.orchestration.QuestionnaireOrchestrationService;
import com.pkb.fhir.orchestration.config.GrpcClientConfig;
import com.pkb.oauth2.client.Oauth2Client;
import com.pkb.oauth2.client.Oauth2ClientImp;
import com.pkb.oauth2.client.Oauth2ServiceCall;
import com.pkb.questionnaireservice.client.QuestionnaireServiceClient;
import com.pkb.questionnaireservice.client.QuestionnaireServiceClientImpl;
import com.pkb.util.CorrelationIdUtil;
import io.micrometer.core.instrument.MeterRegistry;
import io.vavr.collection.HashSet;
import io.vavr.collection.List;
import okhttp3.OkHttpClient;
import org.apache.camel.CamelContext;
import org.apache.camel.ProducerTemplate;
import org.jetbrains.annotations.NotNull;
import org.mapstruct.factory.Mappers;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.boot.web.servlet.ServletRegistrationBean;
import org.springframework.cloud.context.scope.refresh.RefreshScope;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import org.springframework.core.annotation.Order;
import org.springframework.core.env.ConfigurableEnvironment;
import org.springframework.scheduling.annotation.EnableScheduling;
import org.springframework.web.client.RestTemplate;

import javax.annotation.ParametersAreNonnullByDefault;
import javax.persistence.EntityManager;
import java.security.SecureRandom;
import java.util.Optional;
import java.util.Set;

import static ca.uhn.fhir.context.FhirContext.forDstu3;
import static com.pkb.api.fhir.FhirApiServer.FHIR_API_URL_PATTERN;
import static java.lang.invoke.MethodHandles.lookup;

@SuppressWarnings({&quot;ClassWithTooManyMethods&quot;, &quot;OverlyComplexClass&quot;})
@ComponentScan(basePackages = {
        &quot;com.pkb.datamodel.entity.mapper&quot;,
        &quot;com.pkb.domain.routing&quot;
})
@Import({
        DatamodelEntityMappersConfig.class,
        DeletionServiceConfiguration.class,
        GrpcClientConfig.class
})
@ParametersAreNonnullByDefault
@Configuration
@EnableConfigurationProperties({DomainServiceProperties.class, FhirPkbDomainRepositoryProperties.class, FhirApiProperties.class, HybridMailProperties.class,
        LetterInvitationProperties.class, OAuth2Properties.class, OrchestrationProperties.class})
@EnableScheduling
<span class="fc" id="L266">public class FhirApiConfig {</span>
<span class="fc" id="L267">    private static final Logger LOG = LoggerFactory.getLogger(lookup().lookupClass());</span>

    @Bean
    public FhirApiServer fhirApiServer(FhirContext fhirContext,
                                       FhirApiProperties fhirConfig,
                                       AuthenticationExtractingInterceptor authenticationExtractingInterceptor,
                                       MetricsInterceptor metricsInterceptor,
                                       AuthenticationExceptionHandlingInterceptor authenticationExceptionHandlingInterceptor,
                                       ExceptionLoggingInterceptor exceptionLoggingInterceptor,
                                       ContentTypeInterceptor contentTypeInterceptor,
                                       RequestIdInterceptor requestIdInterceptor,
                                       java.util.List&lt;IResourceProvider&gt; resourceProviders,
                                       DateTimeService dateTimeService,
                                       IServerAddressStrategy serverAddressStrategy, CorrelationIdUtil correlationIdUtil) {
<span class="fc" id="L281">        return new FhirApiServer(fhirContext,</span>
                fhirConfig,
                authenticationExtractingInterceptor,
                metricsInterceptor,
                authenticationExceptionHandlingInterceptor,
                exceptionLoggingInterceptor,
                contentTypeInterceptor,
                requestIdInterceptor,
<span class="fc" id="L289">                List.ofAll(resourceProviders),</span>
                dateTimeService,
                serverAddressStrategy,
                correlationIdUtil);

    }

    @Bean
    public IServerAddressStrategy serverAddressStrategy(FhirApiProperties config) {
<span class="fc" id="L298">        return new HardcodedServerAddressStrategy(config.getUrl());</span>
    }

    @Bean
    public ServletRegistrationBean&lt;FhirApiServer&gt; fhirServletBean(FhirApiServer fhirApiServer) {
<span class="fc" id="L303">        return new ServletRegistrationBean&lt;&gt;(fhirApiServer, FHIR_API_URL_PATTERN);</span>
    }

    @Bean
    public FhirContext fhirContext() {
<span class="fc" id="L308">        return forDstu3();</span>
    }

    @Bean
    public DateTimeService dateTimeService(BaseConfig config) {
<span class="pc bpc" id="L313" title="1 of 2 branches missed.">        if (config.isFakeDateTimeServiceEnabled()) {</span>
<span class="fc" id="L314">            return new FakeDateTimeService();</span>
        } else {
<span class="nc" id="L316">            return new DefaultDateTimeService();</span>
        }
    }

    @Bean
    public DetailLoggingProvider defaultTestLoggingService() {
<span class="fc" id="L322">        return DefaultDetailLoggingProvider.INSTANCE;</span>
    }

    @Bean
    PubSubNamespaceService getNamespaceService(CamelContext ctx) {
<span class="fc" id="L327">        return new DefaultPubSubNamespaceService(ctx);</span>
    }

    @Bean
    ITestControlServiceConfig getTestSupportServiceConfig(BaseConfig config,
                                                          DateTimeService dateTimeService,
                                                          DetailLoggingProvider testLoggingService,
                                                          ConfigStorage configStorage,
                                                          Set&lt;ClearableInternalState&gt; internalStates,
                                                          PubSubNamespaceService namespaceService) {
<span class="fc" id="L337">        return new TestControlServiceConfig(config.isTestControlEnabled(),</span>
<span class="fc" id="L338">                config.isTestControlRegistrationEnabled(),</span>
<span class="fc" id="L339">                config.getTestControlAppName(),</span>
<span class="fc" id="L340">                config.getTestControlCallbackUrl(),</span>
<span class="fc" id="L341">                config.getTestControlUrl(),</span>
                dateTimeService,
                configStorage,
                internalStates,
                testLoggingService,
                namespaceService,
<span class="fc" id="L347">                Optional.empty());</span>
    }

    @Bean
    public TemporalMapper temporalMapper() {
<span class="fc" id="L352">        return Mappers.getMapper(TemporalMapper.class);</span>
    }

    @Bean
    public PeriodMapper periodMapper() {
<span class="fc" id="L357">        return Mappers.getMapper(PeriodMapper.class);</span>
    }

    @Bean
    public CodingMapper codingMapper() {
<span class="fc" id="L362">        return Mappers.getMapper(CodingMapper.class);</span>
    }

    @Bean
    public ServerResponseExceptionMapper serverResponseExceptionMapper() {
<span class="fc" id="L367">        return new ServerResponseExceptionMapper();</span>
    }

    @Bean
    public ReferenceMapper referenceMapper() {
<span class="fc" id="L372">        return new ReferenceMapper();</span>
    }

    @Bean
    public HumanNameMapper humanNameMapper() {
<span class="fc" id="L377">        return new HumanNameMapper();</span>
    }

    @Bean
    public BundleMapper bundleMapper() {
<span class="fc" id="L382">        return new BundleMapper();</span>
    }

    @Bean
    public RelatedPersonMapper relatedPersonMapper(ReferenceMapper referenceMapper) {
<span class="fc" id="L387">        return new RelatedPersonMapper(referenceMapper);</span>
    }

    @Bean
    public ProvenanceMapper provenanceMapper(@NotNull ReferenceMapper referenceMapper,
                                             @NotNull RelatedPersonMapper relatedPersonMapper,
                                             @NotNull TemporalMapper temporalMapper) {
<span class="fc" id="L394">        return new ProvenanceMapper(referenceMapper, relatedPersonMapper, temporalMapper);</span>
    }

    @Bean
    public Oauth2Client oauth2Client(OAuth2Properties configuration) {
<span class="fc" id="L399">        return new Oauth2ClientImp(new Oauth2ServiceCall(</span>
                new RestTemplate(),
<span class="fc" id="L401">                configuration.getBaseUrl(),</span>
<span class="fc" id="L402">                configuration.getPhrClientUsername(),</span>
<span class="fc" id="L403">                configuration.getPhrClientPassword(),</span>
<span class="fc" id="L404">                configuration.getPhrClientTokenCacheExpireMinutes()));</span>
    }

    @Bean
    public NamedParameterFactory namedParameterFactory() {
<span class="fc" id="L409">        return new NamedParameterFactory();</span>
    }

    @Bean
    public ReferenceParamToUUIDConverter referenceParamConverter() {
<span class="fc" id="L414">        return new ReferenceParamToUUIDConverter();</span>
    }

    @Bean
    public ReferenceToTypeAndUUIDConverter referenceConverter() {
<span class="fc" id="L419">        return new ReferenceToTypeAndUUIDConverter();</span>
    }
    
    @Bean
<span class="fc" id="L423">    public IdentifierConverter identiferConverter() { return new IdentifierConverter(); }</span>

    @Bean
    public DateParamToDateRestrictionConverter dateParamToDateRestrictionConverter() {
<span class="fc" id="L427">        return new DateParamToDateRestrictionConverter();</span>
    }

    @Bean
    public DateRangeParamToDateRangeRestrictionConverter dateRangeParamToDateRangeRestrictionConverter(DateParamToDateRestrictionConverter dateParamToDateRestrictionConverter) {
<span class="fc" id="L432">        return new DateRangeParamToDateRangeRestrictionConverter(dateParamToDateRestrictionConverter);</span>
    }

    @Bean
    public ReverseIncludeConverter reverseIncludeConverter() {
<span class="fc" id="L437">        return new ReverseIncludeConverter();</span>
    }

    @Bean
    public AccessTokenMapper accessTokenMapper() {
<span class="fc" id="L442">        return new AccessTokenMapper();</span>
    }

    @Bean
    public CorrelationIdUtil correlationIdUtil() {
<span class="fc" id="L447">        return new CorrelationIdUtil();</span>
    }

    @Bean
    public MetricsInterceptor metricsInterceptor(ApiAuthSessionRepository apiAuthSessionRepository,
                                                 AccessTokenMapper accessTokenMapper,
                                                 MeterRegistry meterRegistry) {
<span class="fc" id="L454">        return new MetricsInterceptor(apiAuthSessionRepository, accessTokenMapper, meterRegistry);</span>
    }

    @Bean
    public RequestIdInterceptor requestIdInterceptor() {
<span class="fc" id="L459">        return new RequestIdInterceptor();</span>
    }


    @Bean
    public AuthenticationExtractingInterceptor authenticationExtractingInterceptor() {
<span class="fc" id="L465">        return new AuthenticationExtractingInterceptor();</span>
    }

    @Bean
    public AuthenticationExceptionHandlingInterceptor authenticationExceptionHandlingInterceptor() {
<span class="fc" id="L470">        return new AuthenticationExceptionHandlingInterceptor();</span>
    }

    @Bean
    public ExceptionLoggingInterceptor exceptionLoggingInterceptor() {
<span class="fc" id="L475">        return new ExceptionLoggingInterceptor();</span>
    }

    @Bean
    public Oauth2ServiceBackedJwtBasedLoginService oauth2ServiceBackedJwtBasedLoginManager(Oauth2Client oauth2Client,
                                                                                           AccountRepository accountRepository,
                                                                                           AccountMapper accountMapper,
                                                                                           OrgRepository orgRepository,
                                                                                           TeamRepository teamRepository,
                                                                                           TeamWithOrgMapper teamWithOrgMapper) {
<span class="fc" id="L485">        return new Oauth2ServiceBackedJwtBasedLoginService(oauth2Client,</span>
                accountRepository,
                accountMapper,
                orgRepository,
                teamRepository,
                teamWithOrgMapper);
    }

    @Bean
    public AuthenticatedIdentityService authenticatedIdentityService(AuthnDataRepository authnDataRepository) {
<span class="fc" id="L495">        return new AuthenticatedIdentityService(authnDataRepository);</span>
    }

    @Bean
    public com.pkb.internal.crypto.CryptoService internalCryptoService() {
<span class="fc" id="L500">        return new com.pkb.internal.crypto.CryptoService();</span>
    }

    @Bean
    public DbBackedAccessTokenBasedLoginService dbBackedAccessTokenBasedLoginService(AuthenticatedIdentityService authenticatedIdentityService,
                                                                                     DateTimeService dateTimeService,
                                                                                     com.pkb.internal.crypto.CryptoService cryptoService,
                                                                                     AuthnDataRepository authnDataRepository,
                                                                                     PersonRepository personRepository) {
<span class="fc" id="L509">        return new DbBackedAccessTokenBasedLoginService(authenticatedIdentityService,</span>
                dateTimeService,
                cryptoService,
                authnDataRepository, personRepository);
    }

    @Bean
    public AuthenticationService authenticationService(AccessTokenMapper accessTokenMapper,
                                                       DbBackedAccessTokenBasedLoginService dbBackedAccessTokenBasedLoginService,
                                                       Oauth2ServiceBackedJwtBasedLoginService oauth2ServiceBackedJwtBasedLoginService) {
<span class="fc" id="L519">        return new AuthenticationService(</span>
                accessTokenMapper,
                dbBackedAccessTokenBasedLoginService,
                oauth2ServiceBackedJwtBasedLoginService);
    }

    @Bean
    public ContentTypeInterceptor contentTypeInterceptor() {
<span class="fc" id="L527">        return new ContentTypeInterceptor();</span>
    }

    @Bean
    public PractitionerMapper practitionerMapper(HumanNameMapper nameMapper, AddressMapper addressMapper, ContactPointMapper contactPointMapper) {
<span class="fc" id="L532">        return new PractitionerMapper(nameMapper,addressMapper,contactPointMapper);</span>
    }

    @Bean
    public PractitionerDemographicsService practitionerDemographicsService(
            AuthorizationService authorizationService,
            PersonDemographicsRepository personDemographicsRepository,
            PersonDemographicsMapper personDemographicsMapper) {
<span class="fc" id="L540">        return new PractitionerDemographicsService(</span>
                authorizationService,
                personDemographicsRepository,
                personDemographicsMapper);
    }

    @Bean
    public PractitionerResourceService practitionerService(
            AuthorizationDataService authorizationDataService,
            PractitionerDemographicsService practitionerDemographicsService,
            PractitionerMapper practitionerMapper,
            ServerResponseExceptionMapper exceptionMapper) {
<span class="fc" id="L552">        return new PractitionerResourceService(authorizationDataService, practitionerDemographicsService, practitionerMapper, exceptionMapper);</span>
    }

    @Bean
    public PractitionerResourceProvider practitioner(AuthenticationService authenticationService,
                                                     PractitionerResourceService practitionerResourceService) {
<span class="fc" id="L558">        return new PractitionerResourceProvider(authenticationService,</span>
                practitionerResourceService);
    }

    @Bean
    public ContactPointMapper contactPointMapper() {
<span class="fc" id="L564">        return new ContactPointMapper();</span>
    }

    @Bean
    public AddressMapper addressMapper() {
<span class="fc" id="L569">        return new AddressMapper();</span>
    }

    @Bean
    public FhirCodeSystemToNationalIdTypeMapper fhirCodeSystemToNationalIdTypeMapper() {
<span class="fc" id="L574">        return new FhirCodeSystemToNationalIdTypeMapper();</span>
    }

    @Bean
    public ParametersToPatientIdentifiersDTOMapper parametersToPatientIdentifiersDTOMapper(FhirCodeSystemToNationalIdTypeMapper fhirCodeSystemToNationalIdTypeMapper) {
<span class="fc" id="L579">        return new ParametersToPatientIdentifiersDTOMapper(fhirCodeSystemToNationalIdTypeMapper);</span>
    }

    @Bean
    public PatientMapper patientMapper(
            ContactPointMapper contactPointMapper,
            AddressMapper addressMapper,
            HumanNameMapper nameMapper) {
<span class="fc" id="L587">        return new PatientMapper(contactPointMapper, addressMapper, nameMapper);</span>
    }

    @Bean
    public PatientDemographicsService patientDemographicsService(AuthorizationService authorizationService,
                                                                 PersonDemographicsRepository personDemographicsRepository,
                                                                 PersonDemographicsMapper personDemographicsMapper) {
<span class="fc" id="L594">        return new PatientDemographicsService(authorizationService, personDemographicsRepository, personDemographicsMapper);</span>
    }

    @Bean
    public ConsentService consentService(PersonRepository personRepository,
                                         com.pkb.datamodel.entity.mapper.PersonMapper personMapper,
                                         TeamRepository teamRepository,
                                         TeamMapper teamMapper,
                                         PatientConsentRepository patientConsentRepository,
                                         AuthorizationService authorizationService,
                                         PatientConsentMapper patientConsentMapper) {
<span class="fc" id="L605">        return new ConsentService(</span>
                personRepository,
                personMapper,
                teamRepository,
                teamMapper,
                patientConsentRepository,
                patientConsentMapper,
                authorizationService);
    }

    @Bean
    public MenuDataPointRepository menuDataPointRepository(AppMenuDataRepository menuDataRepository,
                                                           ReferenceDatumRepository referenceDatumRepository,
                                                           PersonRepository personRepository,
                                                           DateOfLastDataPointMapper dateOfLastDataPointMapper) {
<span class="fc" id="L620">        return new MenuDataPointRepository(menuDataRepository,</span>
                referenceDatumRepository,
                personRepository,
                dateOfLastDataPointMapper);
    }

    @Bean
    public PatientService patientService(
            AuthorizationService authorizationService,
            PersonRepository personRepo,
            com.pkb.datamodel.entity.mapper.PersonMapper personMapper,
            InstituteUserRepository instituteUserRepo,
            MenuDataPointRepository dataPointRepo,
            TeamLevelIdRepository teamLevelIdRepository,
            OrgLevelIdRepository orgLevelIdRepository,
            NationalIdRepository nationalIdRepository,
            DateOfLastDataPointMapper dateOfLastDataPointMapper) {
<span class="fc" id="L637">        return new PatientService(</span>
                authorizationService,
                personRepo,
                personMapper,
                instituteUserRepo,
                dataPointRepo,
                teamLevelIdRepository,
                orgLevelIdRepository,
                nationalIdRepository,
                dateOfLastDataPointMapper);
    }

    @Bean
    public PatientResourceService patientResourceService(
            AuthorizationDataService authorizationDataService,
            PatientDemographicsService patientDemographicsService,
            PatientService patientService,
            PatientMapper patientMapper,
            FhirCodeSystemToNationalIdTypeMapper fhirCodeSystemToNationalIdTypeMapper,
            ParametersToPatientIdentifiersDTOMapper parametersToPatientIdentifiersDTOMapper,
            ServerResponseExceptionMapper exceptionMapper,
            HybridMailProperties config) {
<span class="fc" id="L659">        return new PatientResourceService(</span>
                authorizationDataService,
                patientDemographicsService,
                patientMapper,
                patientService,
                fhirCodeSystemToNationalIdTypeMapper,
                parametersToPatientIdentifiersDTOMapper,
                exceptionMapper,
                config);
    }

    @Bean
    public PatientResourceProvider patientResourceProvider(
            AuthenticationService authenticationService,
            PatientResourceService patientResourceService,
            BundleMapper bundleMapper) {
<span class="fc" id="L675">        return new PatientResourceProvider(authenticationService, patientResourceService, bundleMapper);</span>
    }

    @Bean
    public OrganizationMapper organizationMapper(ReferenceMapper referenceMapper) {
<span class="fc" id="L680">        return new OrganizationMapper(referenceMapper);</span>
    }

    @Bean
    public TeamService teamService(AuthorizationService authorizationService,
                                   TeamRepository teamRepository,
                                   TeamWithOrgMapper teamWithOrgMapper) {
<span class="fc" id="L687">        return new TeamService(authorizationService, teamRepository, teamWithOrgMapper);</span>
    }

    @Bean
    public OrganizationResourceService organizationService(
            AuthorizationDataService authorizationDataService,
            TeamService teamService,
            OrganizationMapper organizationMapper,
            ServerResponseExceptionMapper exceptionMapper) {
<span class="fc" id="L696">        return new OrganizationResourceService(authorizationDataService,</span>
                teamService, organizationMapper, exceptionMapper);
    }

    @Bean
    public LetterInvitationValidatorService letterInvitationValidatorService() {
<span class="fc" id="L702">        return new LetterInvitationValidatorService();</span>
    }

    @Bean
    public LetterInvitationTokenService letterInvitationTokenService() {
<span class="fc" id="L707">        return new LetterInvitationTokenService();</span>
    }

    @Bean
    public LetterInvitationService letterInvitationService(DateTimeService dateTimeService,
                                                           LetterInvitationRepository letterInvitationRepository,
                                                           LetterInvitationMapper letterInvitationMapper,
                                                           LetterInvitationValidatorService letterInvitationValidatorService,
                                                           PersonDemographicsRepository personDemographicsRepository,
                                                           AccountUserRepository accountUserRepo,
                                                           LetterInvitationTokenService tokenService,
                                                           CryptoService cryptoService,
                                                           UserAccountKeyLinkRepository userAccountKeyLinkRepository,
                                                           LetterInvitationProperties config,
                                                           OrgRepository orgRepository) {
<span class="fc" id="L722">        return new LetterInvitationService(dateTimeService,</span>
                letterInvitationRepository,
                letterInvitationMapper,
                letterInvitationValidatorService,
                personDemographicsRepository,
                accountUserRepo,
                tokenService,
                cryptoService,
                userAccountKeyLinkRepository,
                config,
                orgRepository);
    }

    @Bean
    public LetterInvitationResourceService letterInvitationsService(LetterInvitationService letterInvitationService,
                                                                    ParametersToPatientIdentifiersDTOMapper parametersToPatientIdentifiersDTOMapper,
                                                                    AuthorizationDataService authorizationDataService,
                                                                    AuthorizationService authorizationService,
                                                                    HybridMailProperties config) {
<span class="fc" id="L741">        return new LetterInvitationResourceService(letterInvitationService,</span>
                parametersToPatientIdentifiersDTOMapper, authorizationDataService, authorizationService,
                config);
    }

    @Bean
    public OrganizationResourceProvider organization(AuthenticationService authenticationService,
                                                     OrganizationResourceService organizationResourceService,
                                                     LetterInvitationResourceService letterInvitationResourceService) {
<span class="fc" id="L750">        return new OrganizationResourceProvider(authenticationService, organizationResourceService, letterInvitationResourceService);</span>
    }

    @Bean
    public ObservationMapper observationMapper(TemporalMapper temporalMapper) {
<span class="fc" id="L755">        return new ObservationMapper(temporalMapper);</span>
    }

    @Bean
    public TokenParamToObservationCategoryConverter observationCategoryConverter() {
<span class="fc" id="L760">        return new TokenParamToObservationCategoryConverter();</span>
    }

    @Bean
    public AccessFilterMapper accessFilterMapper() {
<span class="fc" id="L765">        return new AccessFilterMapper();</span>
    }

    @Bean
    public LabResultRepository labResultRepository(LabResultMapper mapper,
                                                   AccessFilterMapper accessFilterMapper,
                                                   AppMenuDataRepository menuDataRepository,
                                                   ReferenceDatumRepository referenceDatumRepository,
                                                   PersonRepository personRepository) {
<span class="fc" id="L774">        return new LabResultRepository(mapper, accessFilterMapper, menuDataRepository, referenceDatumRepository, personRepository);</span>
    }

    @Bean
    public OkHttpClient httpClient() {
<span class="fc" id="L779">        return new OkHttpClient();</span>
    }

    @Bean
    public SynchUploadedDataService synchUploadedDataService(FhirPkbDomainRepositoryProperties config,
                                                             OkHttpClient httpClient) {
<span class="fc" id="L785">        return new SynchUploadedDataService(config, httpClient);</span>
    }

    @Bean
    public LabResultService labResultService(LabResultRepository labResultRepository,
                                             AuthorizationService authorizationService,
                                             SynchUploadedDataService synchUploadedDataService) {
<span class="fc" id="L792">        return new LabResultService(labResultRepository, authorizationService, synchUploadedDataService);</span>
    }

    @Bean
    public ObservationResourceService observationSearchService(AuthorizationDataService authorizationDataService,
                                                               ServerResponseExceptionMapper exceptionMapper,
                                                               ObservationMapper observationMapper,
                                                               LabResultService labResultService,
                                                               FhirApiProperties fhirConfig) {
<span class="fc" id="L801">        return new ObservationResourceService(authorizationDataService,</span>
                exceptionMapper,
                observationMapper,
                labResultService,
                fhirConfig);
    }

    @Bean
    public ObservationResourceProvider observation(AuthenticationService authenticationService,
                                                   ObservationResourceService searchService,
                                                   ReferenceParamToUUIDConverter referenceParamConverter,
                                                   DateRangeParamToDateRangeRestrictionConverter dateRangeParamToDateRangeRestrictionConverter,
                                                   TokenParamToObservationCategoryConverter observationCategoryConverter,
                                                   BundleMapper bundleMapper) {
<span class="fc" id="L815">        return new ObservationResourceProvider(authenticationService,</span>
                searchService,
                referenceParamConverter,
                dateRangeParamToDateRangeRestrictionConverter,
                observationCategoryConverter,
                bundleMapper);
    }

    @Bean
    public UUIDConverter uuidConverter() {
<span class="fc" id="L825">        return new UUIDConverter();</span>
    }

    @Bean
    public UrnUUIDConverter urnUUIDConverter(UUIDConverter uuidConverter) {
<span class="fc" id="L830">        return new UrnUUIDConverter(uuidConverter);</span>
    }

    @Bean
    public OrgLevelIdTypeMapper orgLevelIdTypeMapper() {
<span class="fc" id="L835">        return new OrgLevelIdTypeMapper();</span>
    }

    @Bean
    public TeamLevelIdTypeMapper teamLevelIdTypeMapper() {
<span class="fc" id="L840">        return new TeamLevelIdTypeMapper();</span>
    }

    @Bean
    public TeamLevelIdTypeService teamLevelIdTypeService(AuthorizationService authorizationService,
                                                         TeamLevelIdTypeRepository repository,
                                                         com.pkb.datamodel.entity.mapper.TeamLevelIdTypeMapper teamLevelIdTypeMapper) {
<span class="fc" id="L847">        return new TeamLevelIdTypeService(authorizationService,</span>
                repository,
                teamLevelIdTypeMapper);
    }

    @Bean
    public OrgLevelIdTypeService orgLevelIdTypeService(AuthorizationService authorizationService,
                                                       OrgLevelIdTypeRepository repository,
                                                       com.pkb.datamodel.entity.mapper.OrgLevelIdTypeMapper orgLevelIdTypeMapper) {
<span class="fc" id="L856">        return new OrgLevelIdTypeService(authorizationService,</span>
                repository,
                orgLevelIdTypeMapper);
    }

    @Bean
    public NamingSystemResourceService namingSystemService(
            AuthorizationDataService authorizationDataService,
            ServerResponseExceptionMapper serverResponseExceptionMapper,
            TeamLevelIdTypeService teamLevelIdTypeService,
            OrgLevelIdTypeService orgLevelIdTypeService,
            OrgLevelIdTypeMapper orgLevelIdTypeMapper,
            TeamLevelIdTypeMapper teamLevelIdTypeMapper) {
<span class="fc" id="L869">        return new NamingSystemResourceService(authorizationDataService, teamLevelIdTypeService, orgLevelIdTypeService, orgLevelIdTypeMapper,</span>
                teamLevelIdTypeMapper, serverResponseExceptionMapper);
    }

    @Bean
    public NamingSystemResourceProvider namingSystem(AuthenticationService authenticationService,
                                                     NamingSystemResourceService resourceService,
                                                     BundleMapper bundleMapper,
                                                     UrnUUIDConverter urnUUIDConverter) {
<span class="fc" id="L878">        return new NamingSystemResourceProvider(authenticationService,</span>
                resourceService,
                urnUUIDConverter,
                bundleMapper);
    }

    @Bean
    public EncounterMapper encounterMapper(
            TemporalMapper timeMapper,
            ProvenanceMapper provenanceMapper,
            CodingMapper codingMapper,
            PeriodMapper periodMapper) {
<span class="fc" id="L890">        return new EncounterMapper(timeMapper, provenanceMapper, codingMapper, periodMapper);</span>
    }

    @Bean
    public JooqSupportRepository jooqSupportRepository() {
<span class="fc" id="L895">        return new JooqSupportRepository();</span>
    }

    @Bean
    public EncounterRepository encounterRepository(AppMenuDataRepository menuDataRepository,
                                                   ReferenceDatumRepository referenceDatumRepository,
                                                   com.pkb.datamodel.entity.mapper.EncounterMapper encounterMapper,
                                                   AccessFilterMapper accessFilterMapper,
                                                   JooqSupportRepository jooqSupportRepository,
                                                   PersonRepository personRepository) {
<span class="fc" id="L905">        return new EncounterRepository(menuDataRepository,</span>
                referenceDatumRepository,
                encounterMapper,
                accessFilterMapper,
                jooqSupportRepository,
                personRepository);
    }

    @Bean
    public EncounterService encounterService(AuthorizationService authorizationService,
                                             EncounterRepository encounterRepository,
                                             SynchUploadedDataService synchUploadedDataService) {
<span class="fc" id="L917">        return new EncounterService(authorizationService,</span>
                encounterRepository,
                synchUploadedDataService);
    }

    @Bean
    public EncounterResourceService encounterResourceService(
            EncounterService service,
            EncounterMapper mapper,
            ServerResponseExceptionMapper exceptionMapper,
            AuthorizationDataService authorizationDataService,
            FhirApiProperties config) {
<span class="fc" id="L929">        return new EncounterResourceService(service, mapper, exceptionMapper, authorizationDataService, config);</span>
    }

    @Bean
    public EncounterResourceProvider encounter(AuthenticationService authenticationService,
                                               EncounterResourceService encounterResourceService,
                                               ReferenceParamToUUIDConverter referenceParamToUUIDConverter,
                                               DateRangeParamToDateRangeRestrictionConverter dateRangeConverter,
                                               BundleMapper bundleMapper,
                                               ReverseIncludeConverter reverseIncludeConverter) {
<span class="fc" id="L939">        return new EncounterResourceProvider(authenticationService,</span>
                encounterResourceService,
                referenceParamToUUIDConverter,
                dateRangeConverter,
                reverseIncludeConverter,
                bundleMapper);
    }

    @Bean
    public TokenParamToDocumentStatusConverter documentStatusConverter() {
<span class="fc" id="L949">        return new TokenParamToDocumentStatusConverter();</span>
    }

    @Bean
    public PrivacyFlagsMapper privacyFlagsMapper() {
<span class="fc" id="L954">        return new PrivacyFlagsMapper();</span>
    }

    @Bean
    public SpecialtyMapper specialtyMapper() {
<span class="fc" id="L959">        return new SpecialtyMapper();</span>
    }

    @Bean
    public DocumentReferenceMapper documentReferenceMapper(ReferenceMapper referenceMapper,
                                                           TemporalMapper timeMapper,
                                                           PrivacyFlagsMapper privacyFlagsMapper,
                                                           SpecialtyMapper specialtyMapper) {
<span class="fc" id="L967">        return new DocumentReferenceMapper(referenceMapper, timeMapper, privacyFlagsMapper, specialtyMapper);</span>
    }

    @Bean
    public ReadReceiptRepository readReceiptRepository(AppMenuDataRepository menuDataRepository,
                                                       ReferenceDatumRepository referenceDatumRepository,
                                                       UnreadableDocumentRepository unreadableDocumentRepository,
                                                       PersonRepository personRepository) {
<span class="fc" id="L975">        return new ReadReceiptRepository(menuDataRepository, referenceDatumRepository, unreadableDocumentRepository, personRepository);</span>
    }

    @Bean
    public MenuDataTargetOwnerFinder menuDataTargetOwnerFinder(AuthorizationService authorizationService,
                                                               AuthorizationDataService authorizationDataService,
                                                               PersonRepository personRepository,
                                                               com.pkb.datamodel.entity.mapper.PersonMapper personMapper,
                                                               AppMenuDataRepository menuDataRepository) {
<span class="fc" id="L984">        return new MenuDataTargetOwnerFinder(authorizationService, authorizationDataService, personRepository, personMapper, menuDataRepository);</span>
    }

    @Bean
    public AccessFilters accessFilters() {
<span class="fc" id="L989">        return new AccessFilters();</span>
    }

    @Bean
    public DocumentMessageRepository documentMessageRepository(AppMenuDataRepository menuDataRepository,
                                                               ReferenceDatumRepository referenceDatumRepository,
                                                               DocumentMessageMapper mapper,
                                                               OrgRepository orgRepository,
                                                               MenuDataTargetOwnerFinder menuDataTargetOwnerFinder,
                                                               AccessFilters accessFilters,
                                                               FhirPkbDomainRepositoryProperties config,
                                                               PersonRepository personRepository) {
<span class="fc" id="L1001">        return new DocumentMessageRepository(menuDataRepository,</span>
                referenceDatumRepository,
                mapper,
                orgRepository,
                menuDataTargetOwnerFinder,
                accessFilters,
                config,
                personRepository);
    }

    @Bean
    public DocumentService documentService(DocumentMessageRepository messageRepository,
                                           ReadReceiptRepository readReceiptRepository,
                                           AuthorizationService authorizationService,
                                           SynchUploadedDataService synchUploadedDataService) {
<span class="fc" id="L1016">        return new DocumentService(messageRepository,</span>
                readReceiptRepository,
                authorizationService,
                synchUploadedDataService);
    }

    @Bean
    public DocumentReferenceResourceService documentReferenceResourceService(
            DocumentService service,
            DocumentReferenceMapper mapper,
            ProvenanceMapper provenanceMapper,
            ServerResponseExceptionMapper exceptionMapper,
            AuthorizationDataService authorizationDataService,
            AuthorizationService authorizationService,
            FhirApiProperties fhirConfig,
            HybridMailProperties hybridMailProperties) {
<span class="fc" id="L1032">        return new DocumentReferenceResourceService(</span>
                service,
                mapper,
                provenanceMapper,
                exceptionMapper,
                authorizationDataService,
                authorizationService,
                fhirConfig,
                hybridMailProperties);
    }

    @Bean
    public DocumentReferenceResourceProvider documentReference(
            AuthenticationService authenticationService,
            DocumentReferenceResourceService resourceService,
            ReferenceParamToUUIDConverter referenceParamToUUIDConverter,
            DateParamToDateRestrictionConverter dateParamToDateRestrictionConverter,
            TokenParamToDocumentStatusConverter documentStatusConverter,
            BundleMapper bundleMapper,
            NamedParameterFactory namedParameterFactory,
            ReverseIncludeConverter reverseIncludeConverter,
            DateRangeParamToDateRangeRestrictionConverter dateRangeParamToDateRangeRestrictionConverter) {
<span class="fc" id="L1054">        return new DocumentReferenceResourceProvider(</span>
                authenticationService,
                resourceService,
                referenceParamToUUIDConverter,
                dateParamToDateRestrictionConverter,
                documentStatusConverter,
                bundleMapper,
                namedParameterFactory,
                reverseIncludeConverter,
                dateRangeParamToDateRangeRestrictionConverter);
    }

    @Bean
    public DiagnosticReportMapper diagnosticReportMapper(TemporalMapper temporalMapper,
                                                         PrivacyFlagsMapper privacyFlagsMapper) {
<span class="fc" id="L1069">        return new DiagnosticReportMapper(temporalMapper, privacyFlagsMapper);</span>
    }

    @Bean
    public TokenParamToDiagnosticReportCategoryConverter diagnosticReportCategoryConverter() {
<span class="fc" id="L1074">        return new TokenParamToDiagnosticReportCategoryConverter();</span>
    }

    @Bean
    public SearchSpecMapper searchSpecMapper() {
<span class="fc" id="L1079">        return new SearchSpecMapper();</span>
    }

    @Bean
    public RadiologyRepository radiologyRepository(AppMenuDataRepository menuDataRepository,
                                                   ReferenceDatumRepository referenceDatumRepository,
                                                   RadiologyMapper radiologyMapper,
                                                   AccessFilterMapper accessFilterMapper,
                                                   SearchSpecMapper searchSpecMapper,
                                                   PersonRepository personRepository) {
<span class="fc" id="L1089">        return new RadiologyRepository(menuDataRepository,</span>
                referenceDatumRepository,
                radiologyMapper,
                accessFilterMapper,
                searchSpecMapper,
                personRepository);
    }

    @Bean
    public RadiologyService radiologyService(RadiologyRepository radiologyRepository,
                                             AuthorizationService authorizationService,
                                             SynchUploadedDataService synchUploadedDataService) {
<span class="fc" id="L1101">        return new RadiologyService(radiologyRepository, authorizationService, synchUploadedDataService);</span>
    }

    @Bean
    public DiagnosticReportResourceService diagnosticReportSearchService(
            ServerResponseExceptionMapper exceptionMapper,
            DiagnosticReportMapper diagnosticReportMapper,
            RadiologyService radiologyService,
            AuthorizationDataService authorizationDataService,
            FhirApiProperties config) {

<span class="fc" id="L1112">        return new DiagnosticReportResourceService(</span>
                exceptionMapper,
                diagnosticReportMapper,
                radiologyService,
                authorizationDataService,
                config);
    }

    @Bean
    public DiagnosticReportResourceProvider diagnosticReport(
            AuthenticationService authenticationService,
            DiagnosticReportResourceService searchService,
            ReferenceParamToUUIDConverter referenceParamConverter,
            DateRangeParamToDateRangeRestrictionConverter dateRangeParamToDateRangeRestrictionConverter,
            TokenParamToDiagnosticReportCategoryConverter diagnosticReportCategoryConverter,
            BundleMapper bundleMapper) {
<span class="fc" id="L1128">        return new DiagnosticReportResourceProvider(</span>
                authenticationService,
                searchService,
                referenceParamConverter,
                dateRangeParamToDateRangeRestrictionConverter,
                diagnosticReportCategoryConverter,
                bundleMapper);
    }

    @Bean
    public ConsentMapper consentMapper(ReferenceMapper referenceMapper, PrivacyFlagsMapper privacyFlagsMapper, RelatedPersonMapper relatedPersonMapper) {
<span class="fc" id="L1139">        return new ConsentMapper(referenceMapper, privacyFlagsMapper, relatedPersonMapper);</span>
    }

    @Bean
    public ConsentResourceService consentResourceService(
            ConsentService service,
            ConsentMapper mapper,
            ReferenceMapper referenceMapper,
            ServerResponseExceptionMapper exceptionMapper,
            AuthorizationDataService authorizationDataService) {
<span class="fc" id="L1149">        return new ConsentResourceService(service, mapper, referenceMapper, exceptionMapper,</span>
                authorizationDataService);
    }

    @Bean
    public ConsentResourceProvider consent(AuthenticationService authenticationService,
                                           ConsentResourceService service,
                                           BundleMapper bundleMapper,
                                           ReferenceParamToUUIDConverter referenceParamConverter,
                                           NamedParameterFactory namedParameterFactory) {
<span class="fc" id="L1159">        return new ConsentResourceProvider(authenticationService,</span>
                service,
                bundleMapper,
                referenceParamConverter,
                namedParameterFactory);
    }

    @Bean
    public CommunicationMapper communicationMapper(TemporalMapper timeMapper,
                                                   PrivacyFlagsMapper privacyFlagsMapper,
                                                   ReferenceMapper referenceMapper,
                                                   RelatedPersonMapper relatedPersonMapper) {
<span class="fc" id="L1171">        return new CommunicationMapper(timeMapper, privacyFlagsMapper, referenceMapper, relatedPersonMapper);</span>
    }

    @Bean
    public CommunicationRepository communicationRepository(AppMenuDataRepository menuDataRepository,
                                                           ReferenceDatumRepository referenceDatumRepository,
                                                           com.pkb.datamodel.entity.mapper.CommunicationMapper communicationMapper,
                                                           AccessFilterMapper accessFilterMapper,
                                                           PersonRepository personRepository,
                                                           com.pkb.datamodel.entity.mapper.PersonMapper personMapper) {
<span class="fc" id="L1181">        return new CommunicationRepository(menuDataRepository,</span>
                referenceDatumRepository,
                communicationMapper,
                accessFilterMapper,
                personRepository, personMapper);
    }

    @Bean
    public CommunicationService communicationService(AuthorizationService authorizationService,
                                                     CommunicationRepository communicationRepository,
                                                     SynchUploadedDataService synchUploadedDataService) {
<span class="fc" id="L1192">        return new CommunicationService(authorizationService, communicationRepository, synchUploadedDataService);</span>
    }

    @Bean
    public CommunicationResourceService communicationResourceService(ServerResponseExceptionMapper exceptionMapper,
                                                                     AuthorizationDataService authzDataService,
                                                                     CommunicationService communicationService,
                                                                     CommunicationMapper communicationMapper,
                                                                     ProvenanceMapper provenanceMapper,
                                                                     FhirApiProperties fhirConfig) {
<span class="fc" id="L1202">        return new CommunicationResourceService(exceptionMapper, authzDataService, communicationService,</span>
                communicationMapper, provenanceMapper, fhirConfig);
    }

    @Bean
    public CommunicationResourceProvider communicationResource(AuthenticationService authenticationService,
                                                               CommunicationResourceService communicationResourceService,
                                                               ReferenceParamToUUIDConverter referenceParamToUUIDConverter,
                                                               DateRangeParamToDateRangeRestrictionConverter dateRangeParamToDateRangeRestrictionConverter,
                                                               NamedParameterFactory namedParameterFactory,
                                                               ReverseIncludeConverter reverseIncludeConverter,
                                                               BundleMapper bundleMapper) {
<span class="fc" id="L1214">        return new CommunicationResourceProvider(authenticationService, communicationResourceService,</span>
                referenceParamToUUIDConverter,
                dateRangeParamToDateRangeRestrictionConverter,
                namedParameterFactory,
                reverseIncludeConverter,
                bundleMapper);
    }

    @Bean
    public PersonService personService(PersonRepository personRepository,
                                       InstituteUserRepository instituteUserRepository,
                                       AuthorizationService authorizationService,
                                       com.pkb.datamodel.entity.mapper.PersonMapper personMapper,
                                       ProducerTemplate pubsubProducer,
                                       DeleteRequestRepository deleteRequestRepository,
                                       ObjectMapper objectMapper,
                                       DateTimeService dateTimeService) {
<span class="fc" id="L1231">        return new PersonService(personRepository,</span>
                instituteUserRepository,
                authorizationService,
                personMapper,
                pubsubProducer, deleteRequestRepository, objectMapper, dateTimeService);
    }



    @Bean
    public PersonMapper personMapper(ReferenceMapper referenceMapper) {
<span class="fc" id="L1242">        return new PersonMapper(referenceMapper);</span>
    }

    @Bean
    public PersonResourceService personResourceService(
            AuthorizationDataService authorizationDataService,
            PersonService personService,
            PersonMapper personMapper,
            ServerResponseExceptionMapper exceptionMapper) {
<span class="fc" id="L1251">        return new PersonResourceService(authorizationDataService, personService, personMapper, exceptionMapper);</span>
    }

    @Bean
    @ConditionalOnProperty(&quot;fhir.api.Person.enabled&quot;)
    public PersonResourceProvider personResourceProvider(
            AuthenticationService authenticationService,
            PersonResourceService personService,
            BundleMapper bundleMapper,
            ReferenceParamToUUIDConverter referenceParamConverter) {
<span class="fc" id="L1261">        return new PersonResourceProvider(authenticationService, personService, bundleMapper, referenceParamConverter);</span>
    }

    @Bean
    @ConditionalOnProperty(&quot;fhir.api.Person.deleteEnabled&quot;)
    public PersonDeleteResourceProvider personDeleteResourceProvider(
            AuthenticationService authenticationService,
            PersonResourceService personService,
            ReferenceParamToUUIDConverter referenceParamConverter) {
<span class="fc" id="L1270">        return new PersonDeleteResourceProvider(authenticationService, personService, referenceParamConverter);</span>
    }

    @Bean
    public AppointmentMapper appointmentMapper(TemporalMapper temporalMapper,
                                               PrivacyFlagsMapper privacyFlagsMapper,
                                               ReferenceMapper referenceMapper,
                                               RelatedPersonMapper relatedPersonMapper,
                                               SpecialtyMapper specialtyMapper) {
<span class="fc" id="L1279">        return new AppointmentMapper(temporalMapper, privacyFlagsMapper, referenceMapper, relatedPersonMapper, specialtyMapper);</span>
    }

    @Bean
    public AppointmentParticipantRepository appointmentParticipantRepository(AppMenuDataRepository menuDataRepository,
                                                                             ReferenceDatumRepository referenceDatumRepository,
                                                                             AppointmentParticipantMapper appointmentParticipantMapper,
                                                                             PersonRepository personRepository) {
<span class="fc" id="L1287">        return new AppointmentParticipantRepository(menuDataRepository,</span>
                referenceDatumRepository,
                appointmentParticipantMapper,
                personRepository);
    }

    @Bean
    public AppointmentRepository appointmentRepository(AppMenuDataRepository menuDataRepository,
                                                       ReferenceDatumRepository referenceDatumRepository,
                                                       com.pkb.datamodel.entity.mapper.AppointmentMapper appointmentMapper,
                                                       AccessFilterMapper accessFilterMapper,
                                                       AppointmentParticipantRepository appointmentParticipantRepository,
                                                       PersonRepository personRepository,
                                                       com.pkb.datamodel.entity.mapper.PersonMapper personMapper) {
<span class="fc" id="L1301">        return new AppointmentRepository(menuDataRepository,</span>
                referenceDatumRepository,
                appointmentMapper,
                accessFilterMapper,
                appointmentParticipantRepository,
                personRepository, personMapper);
    }

    @Bean
    public AppointmentService appointmentService(AppointmentRepository appointmentRepository,
                                                 AuthorizationService authorizationService,
                                                 SynchUploadedDataService synchUploadedDataService) {
<span class="fc" id="L1313">        return new AppointmentService(appointmentRepository, authorizationService, synchUploadedDataService);</span>
    }

    @Bean
    public AppointmentResourceService appointmentResourceService(
            FhirApiProperties config,
            ServerResponseExceptionMapper exceptionMapper,
            AppointmentService appointmentService,
            AppointmentMapper appointmentMapper,
            AuthorizationDataService authorizationDataService,
            ProvenanceMapper provenanceMapper) {
<span class="fc" id="L1324">        return new AppointmentResourceService(exceptionMapper,</span>
                appointmentService,
                appointmentMapper,
                authorizationDataService,
                provenanceMapper,
                config);
    }

    @Bean
    public AppointmentResourceProvider appointmentResource(
            AuthenticationService authenticationService,
            AppointmentResourceService appointmentResourceService,
            ReferenceParamToUUIDConverter referenceParamConverter,
            DateRangeParamToDateRangeRestrictionConverter dateRangeParamToDateRangeRestrictionConverter,
            ReverseIncludeConverter reverseIncludeConverter,
            BundleMapper bundleMapper) {
<span class="fc" id="L1340">        return new AppointmentResourceProvider(authenticationService,</span>
                appointmentResourceService,
                referenceParamConverter,
                dateRangeParamToDateRangeRestrictionConverter,
                reverseIncludeConverter,
                bundleMapper);
    }

    @Bean
    public BaseConfig baseConfig(ConfigStorage configStorage) {
<span class="fc" id="L1350">        return () -&gt; configStorage;</span>
    }

    @Bean
    public ConfigStorage configStorage(ConfigurableEnvironment environment,
                                       RefreshScope refreshScope) {
<span class="fc" id="L1356">        return new SpringBootConfigStorage(environment, refreshScope);</span>
    }

    @Bean
    public AuthorizationService authorizationService(java.util.List&lt;PolicyProvider&gt; policyProviders) {
<span class="fc" id="L1361">        return new PolicyBasedAuthorizationService(HashSet.ofAll(policyProviders)</span>
<span class="fc" id="L1362">                .flatMap(PolicyProvider::policies)</span>
<span class="fc" id="L1363">                .map(policy -&gt; {</span>
<span class="fc" id="L1364">                    LOG.info(&quot;Deploying policy {}&quot;, policy.description());</span>
<span class="fc" id="L1365">                    return policy;</span>
                }));
    }

    @Bean
    public TargetOwnerDataMapper targetOwnerDataMapper(com.pkb.datamodel.entity.mapper.PersonMapper personMapper,
                                                       AccountMapper accountMapper,
                                                       PatientConsentMapper consentMapper,
                                                       TeamMapper teamMapper,
                                                       AccountKeysMapper accountKeysMapper) {
<span class="fc" id="L1375">        return new TargetOwnerDataMapper(personMapper,</span>
                accountMapper,
                consentMapper,
                teamMapper,
                accountKeysMapper);
    }

    @Bean
    public AuthorizationDataRepository authorizationDataRepository(AccountKeysMapper accountKeysMapper,
                                                                   AccountSymmetricKeyRepository accountSymmetricKeyRepository,
                                                                   TargetOwnerDataMapper targetOwnerDataMapper,
                                                                   EntityManager entityManager) {
<span class="fc" id="L1387">        return new AuthorizationDataRepository(accountKeysMapper,</span>
                accountSymmetricKeyRepository,
                targetOwnerDataMapper,
                entityManager);
    }

    @Bean
    public AuthorizationDataService authorizationDataService(AuthorizationDataRepository authorizationDataRepository) {
<span class="fc" id="L1395">        return new RepositoryBackedAuthorizationDataService(authorizationDataRepository);</span>
    }

    @Bean
    public AppointmentPolicyProvider appointmentPolicyProvider() {
<span class="fc" id="L1400">        return new AppointmentPolicyProvider();</span>
    }

    @Bean
    public DocumentMessagePolicyProvider documentMessage() {
<span class="fc" id="L1405">        return new DocumentMessagePolicyProvider();</span>
    }

    @Bean
    public CommunicationPolicyProvider communicationPolicyProvider() {
<span class="fc" id="L1410">        return new CommunicationPolicyProvider();</span>
    }

    @Bean
    public EncounterPolicyProvider encounterPolicyProvider() {
<span class="fc" id="L1415">        return new EncounterPolicyProvider();</span>
    }

    @Bean
    public LabResultPolicyProvider labResultPolicyProvider() {
<span class="fc" id="L1420">        return new LabResultPolicyProvider();</span>
    }

    @Bean
    public LocalIdTypePolicyProvider localIdTypePolicyProvider() {
<span class="fc" id="L1425">        return new LocalIdTypePolicyProvider();</span>
    }

    @Bean
    public OrganizationPolicyProvider organizationPolicyProvider() {
<span class="fc" id="L1430">        return new OrganizationPolicyProvider();</span>
    }

    @Bean
    public PatientPolicyProvider patientPolicyProvider() {
<span class="fc" id="L1435">        return new PatientPolicyProvider();</span>
    }

    @Bean
    public PatientStatusPolicyProvider patientStatusPolicyProvider() {
<span class="fc" id="L1440">        return new PatientStatusPolicyProvider();</span>
    }

    @Bean
    public PatientDateOfLastDataPointPolicyProvider patientDateOfLastDataPointPolicyProvider() {
<span class="fc" id="L1445">        return new PatientDateOfLastDataPointPolicyProvider();</span>
    }

    @Bean
    public PersonPolicyProvider personPolicyProvider() {
<span class="fc" id="L1450">        return new PersonPolicyProvider();</span>
    }

    @Bean
    public PractitionerPolicyProvider practitionerPolicyProvider() {
<span class="fc" id="L1455">        return new PractitionerPolicyProvider();</span>
    }

    @Bean
    public RadiologyImagePolicyProvider radiologyImagePolicyProvider() {
<span class="fc" id="L1460">        return new RadiologyImagePolicyProvider();</span>
    }

    @Bean
    public ConsentPolicyProvider consentPolicyProvider() {
<span class="fc" id="L1465">        return new ConsentPolicyProvider();</span>
    }

    @Bean
    public PurviewPolicyProvider purviewPolicyProvider() {
<span class="fc" id="L1470">        return new PurviewPolicyProvider();</span>
    }

    @Bean
    public ReadReceiptPolicyProvider readReceiptPolicyProvider() {
<span class="fc" id="L1475">        return new ReadReceiptPolicyProvider();</span>
    }

    @Bean
    public InvitationTokenPolicyProvider invitationTokenPolicyProvider() {
<span class="fc" id="L1480">        return new InvitationTokenPolicyProvider();</span>
    }

    @Bean
    public QuestionnairePolicyProvider questionnairePolicyProvider() {
<span class="fc" id="L1485">        return new QuestionnairePolicyProvider();</span>
    }

    @Bean
<span class="fc" id="L1489">    public QuestionnaireRequestPolicyProvider questionnaireRequestPolicyProvider() { return new QuestionnaireRequestPolicyProvider(); }</span>
    
    @Bean
    public QuestionnaireResponsePolicyProvider questionnaireResponsePolicyProvider() {
<span class="fc" id="L1493">        return new QuestionnaireResponsePolicyProvider();</span>
    }

    @Bean
    public QuestionnaireMapper questionnaireMapper(TemporalMapper timeMapper,
                                                   PrivacyFlagsMapper privacyFlagsMapper) {
<span class="fc" id="L1499">        return new QuestionnaireMapper(timeMapper, privacyFlagsMapper);</span>
    }
    
    @Bean
    public QuestionnaireRequestMapper questionnaireRequestMapper(TemporalMapper timeMapper, ReferenceMapper referenceMapper){
<span class="fc" id="L1504">        return new QuestionnaireRequestMapper(timeMapper, referenceMapper);</span>
    }

    @Bean
    public QuestionnaireServiceClient questionnaireServiceClient(FhirApiProperties config,
                                                                 OkHttpClient httpClient) {
<span class="fc" id="L1510">        return new QuestionnaireServiceClientImpl(config.getQuestionnaireServiceUrl(), httpClient);</span>
    }

    @Bean
    public QuestionnaireService questionnaireService(AuthorizationService authorizationService,
                                                     QuestionnaireServiceClient questionnaireServiceClient, CorrelationIdUtil correlationIdUtil) {
<span class="fc" id="L1516">        return new QuestionnaireService(authorizationService, questionnaireServiceClient, correlationIdUtil);</span>
    }

    @Bean
    public QuestionnaireResourceService questionnaireResourceService(AuthorizationDataService authorizationDataService,
                                                                     QuestionnaireMapper questionnaireMapper,
                                                                     ReferenceMapper referenceMapper,
                                                                     QuestionnaireService questionnaireService,
                                                                     PractitionerDemographicsService practitionerDemographicsService,
                                                                     PersonService personService,
                                                                     ServerResponseExceptionMapper exceptionMapper,
                                                                     FhirApiProperties fhirConfig,
                                                                     DateTimeService dateTimeService,
                                                                     OrgRepository orgRepository, QuestionnaireOrchestrationService questionnaireOrchestrationService) {
<span class="fc" id="L1530">        return new QuestionnaireResourceService(authorizationDataService,</span>
                questionnaireMapper,
                referenceMapper,
                questionnaireService,
                practitionerDemographicsService,
                personService,
                exceptionMapper,
                fhirConfig,
                dateTimeService,
                orgRepository,
                questionnaireOrchestrationService);
    }
    
    @Bean ProcedureRequestResourceService procedureRequestResourceService(AuthorizationDataService authorizationDataService,
                                                                          QuestionnaireService questionnaireService,
                                                                          PatientService patientService,
                                                                          QuestionnaireRequestMapper questionnaireRequestMapper,
                                                                          ServerResponseExceptionMapper exceptionMapper){
<span class="fc" id="L1548">        return new ProcedureRequestResourceService(authorizationDataService, questionnaireService, patientService, questionnaireRequestMapper, exceptionMapper);</span>
    }

    @Bean
    public QuestionnaireResourceProvider questionnaireResourceProvider(FhirApiProperties fhirConfig,
                                                                       BundleMapper bundleMapper,
                                                                       ReferenceToTypeAndUUIDConverter referenceToTypeAndUUIDConverter,
                                                                       IdentifierConverter identifierConverter,
                                                                       QuestionnaireResourceService questionnaireResourceService,
                                                                       AuthenticationService authenticationService) {
<span class="fc" id="L1558">        return new QuestionnaireResourceProvider(fhirConfig, bundleMapper, referenceToTypeAndUUIDConverter, identifierConverter, questionnaireResourceService, authenticationService);</span>
    }
    
    @Bean
    public ProcedureRequestResourceProvider procedureRequestResourceProvider(AuthenticationService authenticationService,
                                                                             ProcedureRequestResourceService procedureRequestResourceService) {
<span class="fc" id="L1564">        return new ProcedureRequestResourceProvider(authenticationService, procedureRequestResourceService);</span>
    }

    @Bean
    public QuestionnaireOrchestrationService questionnaireOrchestrationService(QuestionnaireService questionnaireService,
                                                                               ObjectMapper objectMapper,
                                                                               ReactorMessageGrpc.ReactorMessageStub messageReactiveStub,
                                                                               ReactorEmailGrpc.ReactorEmailStub emailReactiveStub) {
<span class="fc" id="L1572">        return new QuestionnaireOrchestrationService(questionnaireService, objectMapper, messageReactiveStub, emailReactiveStub);</span>
    }

    @Bean
    public IncludeConverter includeConverter() {
<span class="fc" id="L1577">        return new IncludeConverter();</span>
    }

    @Bean
    public QuestionnaireResponseService questionnaireResponseService(AuthorizationService authorizationService,
                                                                     QuestionnaireServiceClient questionnaireServiceClient,
                                                                     CorrelationIdUtil correlationIdUtil) {
<span class="fc" id="L1584">        return new QuestionnaireResponseService(authorizationService, questionnaireServiceClient, correlationIdUtil);</span>
    }

    @Bean
    public QuestionnaireResponseMapper questionnaireResponseMapper(TemporalMapper timeMapper,
                                                                   ReferenceMapper referenceMapper,
                                                                   RelatedPersonMapper relatedPersonMapper,
                                                                   QuestionnaireRequestMapper questionnaireRequestMapper) {
<span class="fc" id="L1592">        return new QuestionnaireResponseMapper(timeMapper, referenceMapper, relatedPersonMapper, questionnaireRequestMapper);</span>
    }

    @Bean
    public QuestionnaireResponseResourceService questionnaireResponseResourceService(AuthorizationDataService authorizationDataService,
                                                                                     QuestionnaireResponseMapper questionnaireResponseMapper,
                                                                                     QuestionnaireRequestMapper questionnaireRequestMapper,
                                                                                     PatientService patientService,
                                                                                     QuestionnaireResponseService questionnaireResponseService,
                                                                                     ServerResponseExceptionMapper exceptionMapper,
                                                                                     PatientMapper patientMapper,
                                                                                     FhirApiProperties fhirConfig) {
<span class="fc" id="L1604">        return new QuestionnaireResponseResourceService(authorizationDataService,</span>
                questionnaireResponseMapper,
                questionnaireRequestMapper,
                patientService,
                questionnaireResponseService,
                exceptionMapper,
                patientMapper,
                fhirConfig);
    }

    @Bean
    public QuestionnaireResponseResourceProvider questionnaireResponseResourceProvider(BundleMapper bundleMapper,
                                                                                       NamedParameterFactory parameterFactory,
                                                                                       ReferenceParamToUUIDConverter referenceParamToUUIDConverter,
                                                                                       QuestionnaireResponseResourceService questionnaireResponseResourceService,
                                                                                       DateRangeParamToDateRangeRestrictionConverter dateRangeParamToDateRangeRestrictionConverter,
                                                                                       IncludeConverter includeConverter,
                                                                                       AuthenticationService authenticationService) {
<span class="fc" id="L1622">        return new QuestionnaireResponseResourceProvider(bundleMapper,</span>
                parameterFactory,
                referenceParamToUUIDConverter,
                questionnaireResponseResourceService,
                dateRangeParamToDateRangeRestrictionConverter,
                includeConverter,
                authenticationService);
    }



    @Bean
    @Order
    public static ConfigurationPropertiesScopingPostProcessor configurationPropertiesBeanScopeFixer() {
<span class="fc" id="L1636">        return new ConfigurationPropertiesScopingPostProcessor();</span>
    }

    @Bean
    GuavaModule guavaModule() {
<span class="fc" id="L1641">        return new GuavaModule();</span>
    }


    @Bean
<span class="fc" id="L1646">    SecureRandom secureRandom() { return new SecureRandom(); }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>