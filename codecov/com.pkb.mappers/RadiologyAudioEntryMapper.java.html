<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>RadiologyAudioEntryMapper.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">E2E Tests Coverage Report</a> &gt; <a href="index.source.html" class="el_package">com.pkb.mappers</a> &gt; <span class="el_source">RadiologyAudioEntryMapper.java</span></div><h1>RadiologyAudioEntryMapper.java</h1><pre class="source lang-java linenums">package com.pkb.mappers;

import com.google.common.collect.ImmutableMap;
import com.pkb.app.entity.SourceDetails;
import com.pkb.dto.ActionItemDto;
import com.pkb.dto.ImmutableRadiologyAudioEntryDto;
import com.pkb.dto.ImmutableUrlDto;
import com.pkb.dto.RadiologyAudioEntryDto;
import com.pkb.dto.UrlDto;
import com.pkb.radiology.entity.RadiologyResult;
import com.pkb.service.datapoint.DataWithUIPermissions;
import com.pkb.util.PKBServiceUtil;

import static com.pkb.util.UrlUtil.buildHref;
import static com.pkb.util.WebNamespace.MEDIA;
import static java.lang.String.valueOf;
import static org.apache.commons.lang3.StringUtils.defaultIfBlank;

public class RadiologyAudioEntryMapper implements EntityMapper&lt;RadiologyResult, RadiologyAudioEntryDto, EntityDependency&lt;RadiologyResult&gt;&gt; {

    private PKBServiceUtil pkbServiceUtil;

<span class="fc" id="L23">    public RadiologyAudioEntryMapper(PKBServiceUtil pkbServiceUtil) {</span>
<span class="fc" id="L24">        this.pkbServiceUtil = pkbServiceUtil;</span>
<span class="fc" id="L25">    }</span>

    @Override
    public RadiologyAudioEntryDto entityToDto(DataWithUIPermissions&lt;RadiologyResult&gt; dto,
                                              EntityDependency&lt;RadiologyResult&gt; dependency) {
<span class="fc" id="L30">        RadiologyResult entity = dto.getData();</span>
<span class="fc" id="L31">        SourceDetails source = entity.getSource();</span>
<span class="fc bfc" id="L32" title="All 2 branches covered.">        boolean isImaging = entity.getCategory() == RadiologyResult.MediaActCategory.IMAGING;</span>
<span class="fc" id="L33">        return ImmutableRadiologyAudioEntryDto.builder()</span>
<span class="fc" id="L34">                .sourceSimpleDisplay(defaultIfBlank(source.getDisplayText(),</span>
<span class="fc" id="L35">                                                    pkbServiceUtil.getMessage(&quot;source.not_set&quot;, dependency.getLocale())))</span>
<span class="fc" id="L36">                .sourceFullDisplay(source.getDisplayTextFull())</span>
<span class="fc" id="L37">                .baseFields(entity.getBaseFields())</span>
<span class="fc" id="L38">                .dropdownId(buildDropdownId(entity))</span>
<span class="fc" id="L39">                .title(entity.getTitle())</span>
<span class="fc" id="L40">                .viewUrl(buildViewAnchor(entity, dependency))</span>
<span class="fc" id="L41">                .resultDate(entity.getCreationTimestamp())</span>
<span class="fc bfc" id="L42" title="All 2 branches covered.">                .dateKey(isImaging ? &quot;myRadiology.txt.date_imaging_label&quot; : &quot;myRadiology.txt.date_audio_label&quot;)</span>
<span class="fc" id="L43">                .addAllActions(buildActionItems(dto, dependency))</span>
<span class="fc" id="L44">                .sourceType(buildSourceType(source))</span>
<span class="fc" id="L45">                .route(buildRoute(dto, pkbServiceUtil, dependency.getLocale()))</span>
<span class="fc" id="L46">                .id(entity.getId())</span>
<span class="fc" id="L47">                .build();</span>
    }

    @Override
    public ActionItemDto buildEditActionItem(RadiologyResult entity,
                                             EntityDependency&lt;RadiologyResult&gt; dependency) {
<span class="fc" id="L53">        return buildActionItem(entity, dependency, &quot;edit-data&quot;, &quot;uploadRadiologyResult&quot;,</span>
                &quot;datapoint.txt.edit&quot;);
    }

    @Override
    public ActionItemDto buildDeleteActionItem(RadiologyResult entity,
                                               EntityDependency&lt;RadiologyResult&gt; dependency) {
<span class="fc" id="L60">        return buildActionItem(entity, dependency, &quot;delete-data&quot;, &quot;myRadiology!deleteImageConfirm&quot;,</span>
                &quot;datapoint.txt.delete&quot;);
    }

    @Override
    public ActionItemDto buildPrivacyLabelActionItem(RadiologyResult entity,
                                                     EntityDependency&lt;RadiologyResult&gt; dependency) {
<span class="fc" id="L67">        return buildAction(&quot;change-privacy&quot;,</span>
<span class="fc" id="L68">                ImmutableUrlDto.builder().href(buildHref(MEDIA,</span>
<span class="fc" id="L69">                    &quot;editRadiologyPrivacy_&quot; + entity.getCategory().toString().toLowerCase(),</span>
<span class="fc" id="L70">                    ImmutableMap.of(&quot;dataPointId&quot;, valueOf(entity.getId())),</span>
<span class="fc" id="L71">                    getContextOrAccessingUserId(dependency)))</span>
<span class="fc" id="L72">                .content(pkbServiceUtil.getMessage(&quot;datapoint.txt.edit_privacy&quot;, dependency.getLocale()))</span>
<span class="fc" id="L73">                .build());</span>
    }

    @Override
    public ActionItemDto buildDiscussActionItem(RadiologyResult entity,
                                                EntityDependency&lt;RadiologyResult&gt; dependency) {
<span class="fc" id="L79">        return buildActionItem(entity, dependency, &quot;discuss&quot;, &quot;myRadiology!discussRadiology&quot;,</span>
                &quot;datapoint.txt.discuss&quot;);
    }

    private ActionItemDto buildActionItem(RadiologyResult entity,
                                          EntityDependency&lt;RadiologyResult&gt; dependency,
                                          String cssClass,
                                          String action,
                                          String contentKey) {
<span class="fc" id="L88">        ImmutableMap&lt;String, String&gt; parameters = new ImmutableMap.Builder&lt;String, String&gt;()</span>
<span class="fc" id="L89">                .put(&quot;dataPointId&quot;, valueOf(entity.getId()))</span>
<span class="fc" id="L90">                .put(&quot;subTab&quot;, entity.getCategory().toString().toLowerCase()).build();</span>
<span class="fc" id="L91">        return buildAction(cssClass, ImmutableUrlDto.builder().href(buildHref(MEDIA, action,</span>
                parameters,
<span class="fc" id="L93">                getContextOrAccessingUserId(dependency)))</span>
<span class="fc" id="L94">                .content(pkbServiceUtil.getMessage(contentKey, dependency.getLocale()))</span>
<span class="fc" id="L95">                .build());</span>
    }

    private UrlDto buildViewAnchor(RadiologyResult entity,
                                   EntityDependency&lt;RadiologyResult&gt; dependency) {
<span class="fc" id="L100">        ImmutableMap&lt;String, String&gt; parameters = new ImmutableMap.Builder&lt;String, String&gt;()</span>
<span class="fc" id="L101">                .put(&quot;dataPointId&quot;, valueOf(entity.getId()))</span>
<span class="fc" id="L102">                .put(&quot;uniqueId&quot;, valueOf(entity.getBaseFields().getUniqueId()))</span>
<span class="fc" id="L103">                .put(&quot;subTab&quot;, entity.getCategory().toString().toLowerCase()).build();</span>

<span class="fc" id="L105">        return ImmutableUrlDto.builder()</span>
<span class="fc" id="L106">                .href(buildHref(MEDIA, &quot;myRadiology!viewResult&quot;,</span>
                        parameters,
<span class="fc" id="L108">                        getContextOrAccessingUserId(dependency)))</span>
<span class="fc" id="L109">                .build();</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>