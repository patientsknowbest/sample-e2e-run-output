<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TemplateMetric.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">E2E Tests Coverage Report</a> &gt; <a href="index.source.html" class="el_package">com.pkb.phplan.entity</a> &gt; <span class="el_source">TemplateMetric.java</span></div><h1>TemplateMetric.java</h1><pre class="source lang-java linenums">package com.pkb.phplan.entity;

import com.pkb.annotation.EHRField;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.EnumType;
import javax.persistence.Enumerated;
import javax.persistence.FetchType;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.JoinColumn;
import javax.persistence.ManyToOne;
import javax.persistence.Table;
import java.io.Serializable;

/**
 * A care plan (PHPlan.java) is sometimes, but not always, created from a pre-existing care plan template
 * (PHPlanTemplate.java). A care plan template can be associated with zero to many metrics. A metric is a specific
 * instance of another data type and represents something that should be monitored as part of the care plan.
 * &lt;p&gt;
 * For example, a diabetes-specific care plan might have a glucose lab result as a metric to monitor.
 * &lt;p&gt;
 * Metrics can be lab tests, measurements or symptoms. These are selected by the Team Coordinator when they create a new
 * template in the Plans tab (https://manual.patientsknowbest.com/coordinator/plans).
 * &lt;p&gt;
 * Care plans which have been created from a care plan template will be linked automatically to the same metrics. Care
 * plans which have not been created from a template cannot be linked to any metrics (e.g. submitted via HL7 MDM T02 -
 * https://dev.patientsknowbest.com/home/hl7-api/messages/mdm-t02/care-plan).
 * &lt;p&gt;
 * This class represents a metric associated with a care plan/care plan template. Instances of this class serve two
 * purposes:
 * &lt;ul&gt;
 *     &lt;li&gt;To capture the link between the care plan/care plan template and the metric to be monitored. Instances for
 *     this purpose are stored in PHPlan.metrics/PHPlanTemplate.metrics.&lt;/li&gt;
 *     &lt;li&gt;To temporarily store user-entered values for the associated metric whilst a care plan is being edited.
 *     Instances for this purpose are stored in PHPlan.metricDraftData.&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;p&gt;
 * When a user edits a care plan they are able to enter new responses for each metric linked to the care plan. If the
 * plan is in draft (auto-saved whilst the user is editing) then the responses for each metric are held in an instance
 * of this class up until the plan is saved. When the plan is saved, the responses are converted to new data points of
 * the corresponding type. In this way, the metric sections of the care plan editing form act simply as a shortcut to
 * add new data points for the corresponding metric types. With the exception of this in-draft functionality, a care
 * plan does not otherwise store values separately from the main data store for the data type.
 * &lt;p&gt;
 * For example, when an in-draft care plan with a lab result metric is saved, the lab result value will be removed from
 * the metric holding the response and a new first-class lab result will be created. If the user wants to edit/delete
 * any metrics entered via a care plan they should use the corresponding UI page for that data type.
 */
@Entity
@Table
<span class="fc" id="L54">public class TemplateMetric implements Serializable {</span>
    private static final long serialVersionUID = 1L;

<span class="fc" id="L57">    public enum MetricType {</span>
        // Currently supported
<span class="fc" id="L59">        LAB_TEST,</span>
<span class="fc" id="L60">        MEASUREMENT,</span>
<span class="fc" id="L61">        SYMPTOM,</span>
        // Legacy? MiApp? Unclear if still/ever supported
<span class="fc" id="L63">        PREGNANCY,</span>
<span class="fc" id="L64">        OBSERVATION</span>
    }

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    @EHRField
    private Long id;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = &quot;template_id&quot;)
    private PHPlanTemplate planTemplate;

    @Column
    @Enumerated(EnumType.STRING)
    @EHRField
    private MetricType metricType;

    @Column
    @EHRField
    private String metricName;

    /**
     * The contents of this ID are dependent on the datatype of the metric.
     * For example, this will be LoincTest.id for metrics of type LAB_TEST.
     */
    @Column(nullable = false)
    @EHRField
    private long metricId;

    @Column
    @EHRField
    private Double normalMin;

    @Column
    @EHRField
    private Double normalMax;

    @Column
    @EHRField
    private Double amberLowMin;

    @Column
    @EHRField
    private Double amberLowMax;

    @Column
    @EHRField
    private Double amberHighMin;

    @Column
    @EHRField
    private Double amberHighMax;

    @Column
    @EHRField
    private Double redLowMin;

    @Column
    @EHRField
    private Double redLowMax;

    @Column
    @EHRField
    private Double redHighMin;

    @Column
    @EHRField
    private Double redHighMax;

    // Placeholders for draft data points
    // stored in phPlan trim only

    // See PHR-8106 for a request to combine the date and time fields into a single attribute
    @EHRField
    private String metricDateString;

    @EHRField
    private String metricTimeString;

    @EHRField
    private Long selectedMetricId;

    @EHRField
    private String value1;

    @EHRField
    private String value2;

    @EHRField
    private String value3;

    // List of placeholder field names
    public static final String PHPLAN_METRIC_ID = &quot;metricId&quot;;
    public static final String PHPLAN_METRIC_TYPE = &quot;metricType&quot;;
    public static final String PHPLAN_METRIC_DATE_STRING = &quot;metricDateString&quot;;
    public static final String PHPLAN_METRIC_TIME_STRING = &quot;metricTimeString&quot;;
    public static final String PHPLAN_SELECTED_METRIC_ID = &quot;selectedMetricId&quot;;
    public static final String PHPLAN_VALUE1 = &quot;value1&quot;;
    public static final String PHPLAN_VALUE2 = &quot;value2&quot;;
    public static final String PHPLAN_VALUE3 = &quot;value3&quot;;
    public static final String PHPLAN_NORMAL_MIN = &quot;normalMin&quot;;
    public static final String PHPLAN_NORMAL_MAX = &quot;normalMax&quot;;
    public static final String PHPLAN_AMBER_LOW_MIN = &quot;amberLowMin&quot;;
    public static final String PHPLAN_AMBER_LOW_MAX = &quot;amberLowMax&quot;;
    public static final String PHPLAN_AMBER_HIGH_MIN = &quot;amberHighMin&quot;;
    public static final String PHPLAN_AMBER_HIGH_MAX = &quot;amberHighMax&quot;;
    public static final String PHPLAN_RED_LOW_MIN = &quot;redLowMin&quot;;
    public static final String PHPLAN_RED_LOW_MAX = &quot;redLowMax&quot;;
    public static final String PHPLAN_RED_HIGH_MIN = &quot;redHighMin&quot;;
    public static final String PHPLAN_RED_HIGH_MAX = &quot;redHighMax&quot;;

    public MetricType getMetricType() {
<span class="fc" id="L176">        return metricType;</span>
    }

    public void setMetricType(MetricType metricType) {
<span class="fc" id="L180">        this.metricType = metricType;</span>
<span class="fc" id="L181">    }</span>

    public String getMetricName() {
<span class="fc" id="L184">        return metricName;</span>
    }

    public void setMetricName(String metricName) {
<span class="fc" id="L188">        this.metricName = metricName;</span>
<span class="fc" id="L189">    }</span>

    public PHPlanTemplate getPlanTemplate() {
<span class="nc" id="L192">        return planTemplate;</span>
    }

    public void setPlanTemplate(PHPlanTemplate planTemplate) {
<span class="nc" id="L196">        this.planTemplate = planTemplate;</span>
<span class="nc" id="L197">    }</span>

    public long getMetricId() {
<span class="fc" id="L200">        return metricId;</span>
    }

    public void setMetricId(long metricId) {
<span class="fc" id="L204">        this.metricId = metricId;</span>
<span class="fc" id="L205">    }</span>

    public Long getSelectedMetricId() {
<span class="fc" id="L208">        return selectedMetricId;</span>
    }

    public void setSelectedMetricId(Long selectedMetricId) {
<span class="fc" id="L212">        this.selectedMetricId = selectedMetricId;</span>
<span class="fc" id="L213">    }</span>

    public String getValue1() {
<span class="fc" id="L216">        return value1;</span>
    }

    public void setValue1(String value1) {
<span class="fc" id="L220">        this.value1 = value1;</span>
<span class="fc" id="L221">    }</span>

    public String getValue2() {
<span class="fc" id="L224">        return value2;</span>
    }

    public void setValue2(String value2) {
<span class="fc" id="L228">        this.value2 = value2;</span>
<span class="fc" id="L229">    }</span>

    public String getValue3() {
<span class="fc" id="L232">        return value3;</span>
    }

    public void setValue3(String value3) {
<span class="fc" id="L236">        this.value3 = value3;</span>
<span class="fc" id="L237">    }</span>

    public String getMetricDateString() {
<span class="fc" id="L240">        return metricDateString;</span>
    }

    public String getMetricTimeString() {
<span class="fc" id="L244">        return metricTimeString;</span>
    }

    public void setMetricTimeString(String metricTimeString) {
<span class="fc" id="L248">        this.metricTimeString = metricTimeString;</span>
<span class="fc" id="L249">    }</span>

    public Double getNormalMin() {
<span class="fc" id="L252">        return normalMin;</span>
    }

    public void setNormalMin(Double normalMin) {
<span class="fc" id="L256">        this.normalMin = normalMin;</span>
<span class="fc" id="L257">    }</span>

    public Double getNormalMax() {
<span class="fc" id="L260">        return normalMax;</span>
    }

    public void setNormalMax(Double normalMax) {
<span class="fc" id="L264">        this.normalMax = normalMax;</span>
<span class="fc" id="L265">    }</span>

    public Double getAmberLowMin() {
<span class="fc" id="L268">        return amberLowMin;</span>
    }

    public void setAmberLowMin(Double amberLowMin) {
<span class="fc" id="L272">        this.amberLowMin = amberLowMin;</span>
<span class="fc" id="L273">    }</span>

    public Double getAmberLowMax() {
<span class="fc" id="L276">        return amberLowMax;</span>
    }

    public void setAmberLowMax(Double amberLowMax) {
<span class="fc" id="L280">        this.amberLowMax = amberLowMax;</span>
<span class="fc" id="L281">    }</span>

    public Double getAmberHighMin() {
<span class="fc" id="L284">        return amberHighMin;</span>
    }

    public void setAmberHighMin(Double amberHighMin) {
<span class="fc" id="L288">        this.amberHighMin = amberHighMin;</span>
<span class="fc" id="L289">    }</span>

    public Double getAmberHighMax() {
<span class="fc" id="L292">        return amberHighMax;</span>
    }

    public void setAmberHighMax(Double amberHighMax) {
<span class="fc" id="L296">        this.amberHighMax = amberHighMax;</span>
<span class="fc" id="L297">    }</span>

    public Double getRedLowMin() {
<span class="fc" id="L300">        return redLowMin;</span>
    }

    public void setRedLowMin(Double redLowMin) {
<span class="fc" id="L304">        this.redLowMin = redLowMin;</span>
<span class="fc" id="L305">    }</span>

    public Double getRedLowMax() {
<span class="fc" id="L308">        return redLowMax;</span>
    }

    public void setRedLowMax(Double redLowMax) {
<span class="fc" id="L312">        this.redLowMax = redLowMax;</span>
<span class="fc" id="L313">    }</span>

    public Double getRedHighMin() {
<span class="fc" id="L316">        return redHighMin;</span>
    }

    public void setRedHighMin(Double redHighMin) {
<span class="fc" id="L320">        this.redHighMin = redHighMin;</span>
<span class="fc" id="L321">    }</span>

    public Double getRedHighMax() {
<span class="fc" id="L324">        return redHighMax;</span>
    }

    public void setRedHighMax(Double redHighMax) {
<span class="fc" id="L328">        this.redHighMax = redHighMax;</span>
<span class="fc" id="L329">    }</span>

    public void setMetricDateString(String metricDateString) {
<span class="fc" id="L332">        this.metricDateString = metricDateString;</span>
<span class="fc" id="L333">    }</span>

    public Long getId() {
<span class="fc" id="L336">        return id;</span>
    }

    public void setId(Long id) {
<span class="fc" id="L340">        this.id = id;</span>
<span class="fc" id="L341">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>