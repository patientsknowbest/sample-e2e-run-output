<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PHPlan.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">E2E Tests Coverage Report</a> &gt; <a href="index.source.html" class="el_package">com.pkb.phplan.entity</a> &gt; <span class="el_source">PHPlan.java</span></div><h1>PHPlan.java</h1><pre class="source lang-java linenums">//---------------------------------------------------------------------------
//
// Copyright (c) 2009-2013 PatientsKnowBest, Inc. All Rights Reserved.
//
// $Id: PersonalHealthPlan.java Jun 30, 2011 12:03:14 AM pravinam$
//
//---------------------------------------------------------------------------

package com.pkb.phplan.entity;

import com.pkb.annotation.EHRField;
import com.pkb.annotation.EHRField.QueryField;
import com.pkb.app.dto.DTOBaseFields;
import com.pkb.app.entity.SourceDetails;
import com.pkb.app.interfaces.EncryptedDataPoint;
import com.pkb.app.interfaces.IBaseDTO;
import com.pkb.document.entity.Attachment;
import com.pkb.entities.enums.MenuDataType;
import com.pkb.phplan.entity.PHPlanTemplate.TemplateFieldLabel;
import com.pkb.user.entity.PKBPerson;

import javax.annotation.Nullable;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Date;
import java.util.List;

/**
 * Health plan specific to patient's condition
 *
 * @author pravinam
 */
public class PHPlan implements IBaseDTO, EncryptedDataPoint {

<span class="fc" id="L35">    public static final MenuDataType MS_PATH_PHPLAN = MenuDataType.phplan;</span>

    private static final long serialVersionUID = 1L;

<span class="fc" id="L39">    public enum PlanStatus {</span>
<span class="fc" id="L40">        APPROVED, INDRAFT, ACTIVE, DELETED, COMPLETED, NULL</span>
    }

<span class="fc" id="L43">    public enum ApprovalStatus {</span>
<span class="fc" id="L44">        APPROVED, AWAITING_APPROVAL, NULL</span>
    }

<span class="fc" id="L47">    public enum EditableStatus {</span>
<span class="fc" id="L48">        ALL, CREATOR</span>
    }

<span class="fc" id="L51">    public enum Lazy {</span>
<span class="fc" id="L52">        ACTIVE_VERSION_COUNT, CREATOR_DETAILS, LAST_EDITOR_DEATILS</span>
    }

    @EHRField(queryField = QueryField.id)
    private Long id;

    // private String uniquePlanId;

    @EHRField
    private String name;

    @EHRField
    private String description;//FHIR attribute

    @EHRField
    private String note; //FHIR attribute ; Comments about the plan

    @EHRField(queryField = QueryField.long03)
    private Long patientId;

    private List&lt;Attachment&gt; attachments;

    private Attachment attachmentAsActionPlanContent;

    @EHRField
    private List&lt;PlanField&gt; planFields;

    @EHRField
    private List&lt;TemplateMetric&gt; metrics;

    @EHRField
    private List&lt;TemplateMetric&gt; metricDraftData; // For storing draft data

    @EHRField(queryField = QueryField.long01)
    private Long creatorId;

    @EHRField(queryField = QueryField.date01)
    private Date creationDate;

    @EHRField(queryField = QueryField.date02)
    private Date lastEditedOn;

    @EHRField(queryField = QueryField.long02)
    private Long lastEditorId;

    @EHRField(queryField = QueryField.string02)
    private PlanStatus status;

    @EHRField(queryField = QueryField.string03)
    private ApprovalStatus approvalStatus;

    @EHRField
    private Long approverId;

    @EHRField(queryField = QueryField.string04)
    private Long version;

    private int activeVersionCount;

    @EHRField
    private Long templateId;

    @EHRField(queryField = QueryField.date03)
    private Date reviewDate;

    @EHRField(queryField = QueryField.long04)
    private Long uploadedDataId;

<span class="fc" id="L120">    private final DTOBaseFields baseFields = new DTOBaseFields(); // saved in DB by EHRBean</span>

    private SourceDetails source;

    private EditableStatus editableStatus;

    private PKBPerson creator; //loaded on demand

    private PKBPerson lastEditor; // loaded on demand

    // List of placeholder field names
    public static final String PHPLAN_NAME = &quot;name&quot;;

    public static final String PHPLAN_CREATION_DATE = &quot;creationDate&quot;;

    public static final String PHPLAN_CREATOR_ID = &quot;creatorId&quot;;

    public static final String PHPLAN_EDITOR_ID = &quot;editorId&quot;;

    public static final String PHPLAN_PATIENT_ID = &quot;patientId&quot;;

    public static final String PHPLAN_LAST_EDITED_ON = &quot;lastEditedOn&quot;;

    public static final String PHPLAN_DESCRIPTION = &quot;description&quot;;

    public static final String PHPLAN_STATUS = &quot;status&quot;;

    public static final String PHPLAN_APPROVAL_STATUS = &quot;approvalStatus&quot;;

    public static final String PHPLAN_APPROVER_ID = &quot;approverId&quot;;

    public static final String PHPLAN_VERSION = &quot;version&quot;;

    public static final String PHPLAN_UNIQUE_ID = &quot;uniquePlanId&quot;;

    public static final String PHPLAN_UPLOADED_DATA_ID = &quot;uploadedDataId&quot;;

    public static final String PHPLAN_TEMPLATE_ID = &quot;templateId&quot;;

    public static final String PHPLAN_REVIEW_DATE = &quot;reviewDate&quot;;

    public static final String MS_PHPLAN = &quot;pkb:phPlan&quot;;

    public static final String MS_PHPLAN_LIST = &quot;pkb:phPlans:all&quot;;

    public static final String MS_PHPLAN_LATEST = &quot;pkb:latestPHPlans:all&quot;;

    /**
     * DELIBERATELY PROTECTED DO NOT CHANGE! Use the available constructors!
     * &lt;p&gt;
     * Would have even less visibility but JPA spec &amp; Hibernate requires a no arg const. which is public or protected.
     * Other than those, nothing should be able to construct without parameters, as changelog wouldn't be filled correctly etc.
     */
<span class="fc" id="L173">    protected PHPlan() {</span>
<span class="fc" id="L174">        this.source = new SourceDetails();</span>
<span class="fc" id="L175">    }</span>

<span class="fc" id="L177">    public PHPlan(SourceDetails source) {</span>
<span class="fc" id="L178">        this.source = source;</span>
<span class="fc" id="L179">    }</span>

    @Override
    public MenuDataType getDataType() {
<span class="nc" id="L183">        return MenuDataType.phplan;</span>
    }

    @Override
    public Long getPatientAccountId() {
        // to be implemented when batch processing support is in place
<span class="nc" id="L189">        return -1L;</span>
    }

    @Override
    public Long getId() {
<span class="fc" id="L194">        return id;</span>
    }

    @Override
    public void setId(Long id) {
<span class="fc" id="L199">        this.id = id;</span>
<span class="fc" id="L200">    }</span>

    /*
     * public String getUniquePlanId() { return uniquePlanId; }
     *
     * public void setUniquePlanId(String uniquePlanId) { this.uniquePlanId = uniquePlanId; }
     */

    public String getName() {
<span class="fc" id="L209">        return name;</span>
    }

    public void setName(String name) {
<span class="fc" id="L213">        this.name = name;</span>
<span class="fc" id="L214">    }</span>

    public Long getPatientId() {
<span class="fc" id="L217">        return patientId;</span>
    }

    public void setPatientId(Long patientId) {
<span class="fc" id="L221">        this.patientId = patientId;</span>
<span class="fc" id="L222">    }</span>

    public List&lt;Attachment&gt; getAttachments() {
<span class="nc" id="L225">        return attachments;</span>
    }

    public void setAttachments(List&lt;Attachment&gt; attachments) {
<span class="nc" id="L229">        this.attachments = attachments;</span>
<span class="nc" id="L230">    }</span>

    @Nullable
    public Long getCreatorId() {
<span class="fc" id="L234">        return creatorId;</span>
    }

    public void setCreatorId(Long creatorId) {
<span class="fc" id="L238">        this.creatorId = creatorId;</span>
<span class="fc" id="L239">    }</span>

    public Date getCreationDate() {
<span class="fc" id="L242">        return creationDate;</span>
    }

    public void setCreationDate(Date creationDate) {
<span class="fc" id="L246">        this.creationDate = creationDate;</span>
<span class="fc" id="L247">    }</span>

    public Date getLastEditedOn() {
<span class="fc" id="L250">        return lastEditedOn;</span>
    }

    public void setLastEditedOn(Date lastEditedOn) {
<span class="fc" id="L254">        this.lastEditedOn = lastEditedOn;</span>
<span class="fc" id="L255">    }</span>

    public Long getLastEditorId() {
<span class="fc" id="L258">        return lastEditorId;</span>
    }

    public void setLastEditorId(Long lastEditorId) {
<span class="fc" id="L262">        this.lastEditorId = lastEditorId;</span>
<span class="fc" id="L263">    }</span>

    public PlanStatus getStatus() {
<span class="fc" id="L266">        return status;</span>
    }

    public void setStatus(PlanStatus status) {
<span class="fc" id="L270">        this.status = status;</span>
<span class="fc" id="L271">    }</span>

    public Long getTemplateId() {
<span class="fc" id="L274">        return templateId;</span>
    }

    public void setTemplateId(Long templateId) {
<span class="fc" id="L278">        this.templateId = templateId;</span>
<span class="fc" id="L279">    }</span>

    public Long getVersion() {
<span class="fc" id="L282">        return version;</span>
    }

    public void setVersion(Long version) {
<span class="fc" id="L286">        this.version = version;</span>
<span class="fc" id="L287">    }</span>

    public List&lt;PlanField&gt; getPlanFields() {
<span class="fc" id="L290">        return planFields;</span>
    }

    public void setPlanFields(List&lt;PlanField&gt; planFields) {
<span class="fc" id="L294">        this.planFields = planFields;</span>
<span class="fc" id="L295">    }</span>

    public void addField(PlanField planField) {
<span class="fc bfc" id="L298" title="All 2 branches covered.">        if (planFields == null) {</span>
<span class="fc" id="L299">            planFields = new ArrayList&lt;&gt;();</span>
        }
<span class="fc" id="L301">        planFields.add(planField);</span>
<span class="fc" id="L302">    }</span>

    public @Nullable
    PlanField getPlanField(TemplateFieldLabel label) {
<span class="fc bfc" id="L306" title="All 2 branches covered.">        if (planFields != null) {</span>
<span class="fc bfc" id="L307" title="All 2 branches covered.">            for (PlanField planField : planFields) {</span>
<span class="fc bfc" id="L308" title="All 2 branches covered.">                if (planField.getLabel() == label) {</span>
<span class="fc" id="L309">                    return planField;</span>
                }
<span class="fc" id="L311">            }</span>
        }
<span class="fc" id="L313">        return null;</span>
    }

    public int getActiveVersionCount() {
<span class="fc" id="L317">        return activeVersionCount;</span>
    }

    public void setActiveVersionCount(int activeVersionCount) {
<span class="fc" id="L321">        this.activeVersionCount = activeVersionCount;</span>
<span class="fc" id="L322">    }</span>

    public List&lt;TemplateMetric&gt; getMetrics() {
<span class="fc" id="L325">        return metrics;</span>
    }

    public void setMetrics(List&lt;TemplateMetric&gt; metrics) {
<span class="fc" id="L329">        this.metrics = metrics;</span>
<span class="fc" id="L330">    }</span>

    public void addMetric(TemplateMetric templateMetric) {
<span class="nc bnc" id="L333" title="All 2 branches missed.">        if (metrics == null) {</span>
<span class="nc" id="L334">            metrics = new ArrayList&lt;&gt;();</span>
        }
<span class="nc" id="L336">        metrics.add(templateMetric);</span>
<span class="nc" id="L337">    }</span>

    public List&lt;TemplateMetric&gt; getMetricDraftData() {
<span class="fc" id="L340">        return metricDraftData;</span>
    }

    public void addMetricDraftData(TemplateMetric templateMetric) {
<span class="fc bfc" id="L344" title="All 2 branches covered.">        if (metricDraftData == null) {</span>
<span class="fc" id="L345">            metricDraftData = new ArrayList&lt;&gt;();</span>
        }
<span class="fc" id="L347">        metricDraftData.add(templateMetric);</span>
<span class="fc" id="L348">    }</span>

    public void setMetricDraftData(List&lt;TemplateMetric&gt; metricDraftData) {
<span class="fc" id="L351">        this.metricDraftData = metricDraftData;</span>
<span class="fc" id="L352">    }</span>

    public Date getReviewDate() {
<span class="fc" id="L355">        return reviewDate;</span>
    }

    public void setReviewDate(Date reviewDate) {
<span class="fc" id="L359">        this.reviewDate = reviewDate;</span>
<span class="fc" id="L360">    }</span>

    public ApprovalStatus getApprovalStatus() {
<span class="fc" id="L363">        return approvalStatus;</span>
    }

    public void setApprovalStatus(ApprovalStatus approvalStatus) {
<span class="fc" id="L367">        this.approvalStatus = approvalStatus;</span>
<span class="fc" id="L368">    }</span>

    public Long getApproverId() {
<span class="fc" id="L371">        return approverId;</span>
    }

    public void setApproverId(Long approverId) {
<span class="fc" id="L375">        this.approverId = approverId;</span>
<span class="fc" id="L376">    }</span>

    @Override
    public SourceDetails getSource() {
<span class="fc" id="L380">        return source;</span>
    }

    public Long getUploadedDataId() {
<span class="fc" id="L384">        return uploadedDataId;</span>
    }

    public void setUploadedDataId(Long uploadedDataId) {
<span class="fc" id="L388">        this.uploadedDataId = uploadedDataId;</span>
<span class="fc" id="L389">    }</span>

    public EditableStatus getEditableStatus() {
<span class="fc" id="L392">        return editableStatus;</span>
    }

    public void setEditableStatus(EditableStatus editableStatus) {
<span class="fc" id="L396">        this.editableStatus = editableStatus;</span>
<span class="fc" id="L397">    }</span>

    @Override
    public DTOBaseFields getBaseFields() {
<span class="fc" id="L401">        return baseFields;</span>
    }

    public String getDescription() {
<span class="fc" id="L405">        return description;</span>
    }

    public void setDescription(String description) {
<span class="fc" id="L409">        this.description = description;</span>
<span class="fc" id="L410">    }</span>

    public String getNote() {
<span class="fc" id="L413">        return note;</span>
    }

    public void setNote(String note) {
<span class="fc" id="L417">        this.note = note;</span>
<span class="fc" id="L418">    }</span>

    public PKBPerson getCreator() {
<span class="fc" id="L421">        return creator;</span>
    }

    public void setCreator(PKBPerson creator) {
<span class="fc" id="L425">        this.creator = creator;</span>
<span class="fc" id="L426">    }</span>

    public PKBPerson getLastEditor() {
<span class="fc" id="L429">        return lastEditor;</span>
    }

    public void setLastEditor(PKBPerson lastEditor) {
<span class="fc" id="L433">        this.lastEditor = lastEditor;</span>
<span class="fc" id="L434">    }</span>

    public List&lt;Attachment&gt; getAttachmentAsActionPlanContentInCollection() {
<span class="fc" id="L437">        return Collections.singletonList(attachmentAsActionPlanContent);</span>
    }

    public Attachment getAttachmentAsActionPlanContent() {
<span class="fc" id="L441">        return attachmentAsActionPlanContent;</span>
    }

    public void setAttachmentAsActionPlanContent(Attachment attachmentAsActionPlanContent) {
<span class="fc" id="L445">        this.attachmentAsActionPlanContent = attachmentAsActionPlanContent;</span>
<span class="fc" id="L446">    }</span>

    public void setSource(SourceDetails source) {
<span class="fc" id="L449">        this.source = source;</span>
<span class="fc" id="L450">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>